% !TEX root = ../foundations.tex

\section{Interaction with cubical structures}\label{S: transversality}

In this section, we bring in some auxiliary structures that will help us further develop geometric cohomology and its connections to singular cohomology.
In particular, we equip our manifolds with smooth cubulations.
Many of our results would apply just as well with the more familiar smooth triangulations, but we find cubulations to be more convenient.
In particular, in \cite{FMS-flows}, we have considered geometric cochains in the presence of cubulations, demonstrating how to obtain a fully-defined cochain-level cup product via intersection using certain flows developed in terms of the cubulation.
Cup products in geometric cohomology will be discussed in the following section.

Smooth cubulations are analogous to smooth triangulations in that they involve a homeomorphism $M \cong |X|$ between a manifold $M$ and the geometric realization $|X|$ of a cubical complex $X$, such that the restriction to each cubical face is a smooth embedding.
What is slightly different, aside from substituting cubes (i.e.\ copies of $\interval^k$) for simplices, is that cubical complexes require a bit more combinatorial structure; simplicial complexes can always be constructed just by gluing together simplices along faces, while gluing of cubical faces requires a certain combinatorial compatibility among the faces being glued.

The issue is that any simplicial complex can be given a total ordering of its vertices, and this ordering provides a canonical identification between any simplicial face and the standard model simplex of the same dimension.
By contrast, the natural combinatorial structure on the vertices of the standard cube is not a total ordering but rather a partial ordering.
In particular, if we take the standard cube to be $\interval^k = [0,1]^k \subset \R^k$, then we have $v \leq w$ for two vertices if each coordinate of $v$ is less than or equal to the corresponding coordinate of $w$.
There turn out to be spaces obtained from naively gluing cubes that do not support compatible partial orderings of this type among their cubes; for example, see \cref{F: cubical structure}, below.

So when we speak of cubical complexes we will restrict ourselves to complexes that do admit such combinatorial data.
Consequently, each cubical $k$-face comes equipped with an identification with the standard $k$-cube, and hence also a standard orientation.
As we will note below, smooth cubulations of this form exist for any smooth manifold.
In the remainder of this work, ``cubulation'' will always mean a smooth cubulation.

Analogously to simplicial complexes, cubical complexes possess algebraic cubical chain and cochain complexes and so cubical homology and cohomology that coincide with singular homology and cohomology\footnote{We will show below that cubical homology coincides with singular cubical homology, which coincide with simplicial singular homology by \cite{EM53}.
As all of the involved chain complexes are free, the corresponding cohomologies are also isomorphic by basic homological algebra \cite[Theorem 45.5]{Mun84}.\label{FN: cubical and singular}}.
Our primary goal in this section is to see that there are direct geometrically-defined isomorphisms between cubical (co)homology and geometric (co)homology.

For this, we first provide some background on cubical complexes and cubical homology and cohomology in \cref{S: cubes,S: cubical cochains}.
Then in \cref{S: cubical and geometric homology} we show that the obvious map that takes a face of a cube complex to its corresponding geometric chain induces an isomorphism from cubical homology to geometric homology.
Next, in \cref{S: transverse cochains}, we consider those geometric cochains that are transverse to a given cubulation and show that their cohomology agrees with the geometric cohomology obtained without that constraint.

The motivation for our interest in cochains that are transverse to the cubulation is that they allow us to define an \textit{intersection map} $\mc I$ from these transverse geometric cochains to the cubical cochains.
If $F$ is a face of the cubulation, $F^*$ its dual cochain, and $W$ represents a geometric cochain of complementary dimension to $F$, then the coefficient of $F^*$ in $\mc I(W)$ is simply the geometric intersection number of $W$ with $F$.
This intersection map is defined in \cref{S: intersection map}, which also contains our proof that the intersection map induces a cohomology isomorphism when $H^*(M)$ is finitely generated in each degree.
To implement this proof, we include in \cref{S: dual cubes} a discussion of what we call ``central subdivisions'' of cubical complexes, which are analogous to barycentric subdivisions of simplicial complexes and allow us to construct the cubical dual cells to faces of the cubulation.

\subsection{Cubical complexes and cubulations}\label{S: cubes}

We begin by recalling some notation from \cite{FMS-flows}.
In the context of cubical complexes we write the unit interval as $\interval = [0,1]$ and define the \textbf{standard $n$-cube} to be
\begin{equation*}
	\interval^n = \big\{ (x_1, \dots, x_n) \in \R^n\ |\ 0 \leq x_i \leq 1 \big\}.
\end{equation*}
Denote the set $\{1, \dots, n\}$ by $\overline{n}$.

Given a partition $F = (F_0, F_{01}, F_1)$ of $\overline n$, it determines a \textbf{face} of $\interval^n$ given by
\begin{equation*}
	\{(x_1, \dots, x_n) \in \interval^n\ |\ \forall \varepsilon \in \{0, 1\},\ i \in F_\varepsilon \Rightarrow x_i = \varepsilon\}.
\end{equation*}
We abuse notation and write $F$ for both the partition and its associated face.
We refer to coordinates $x_i$ with $i \in F_{01}$ as \textbf{free} and to the others as \textbf{bound}.
The \textbf{dimension} of $F$ is its number of free coordinates, and as usual the faces of dimension $0$ and $1$ are called vertices and edges, respectively.
The set of vertices of $\interval^n$ is denoted by $\vertices(\interval^n)$.
Given any face $F$, its \textbf{initial vertex} is obtained by setting all free coordinates to $0$, and its \textbf{terminal vertex} is obtained by setting all free coordinates to $1$.
We note that $F$ is determined completely by its initial and terminal vertices: $F_0$ is the set of coordinates that are $0$ for both vertices, $F_1$ is the set of coordinates that are $1$ for both vertices, and $F_{01}$ is the set of coordinates that disagree.

\begin{example}
	The partition $(\{1,4,6\},\{3,5\}, \{2\})$ corresponds to the $2$-dimensional face of $\interval^6$ determined by $x_1=x_4=x_6=0$, $x_2=1$, and with $x_3$ and $x_5$ a free to vary in $\interval = [0,1]$.
	Its initial vertex is $(0,1,0,0,0,0)$ and its terminal vertex is $(0,1,1,0,1,0)$.
\end{example}

For $\varepsilon \in \{0, 1\}$ and $i \in \overline{n}$, we define maps $\delta_i^\varepsilon \colon \interval^{n-1} \to \interval^{n}$ by
\begin{align*}
	\delta_i^\varepsilon(x_1, \dots, x_{n-1}) & = (x_1, \dots, x_{i-1}, \varepsilon, x_i, \dots, x_{n-1}).
\end{align*}
Any composition of these is referred to as a \textbf{face inclusion map}.

We also have projection maps $\pi_i \colon \interval^n \to \interval^{n-1}$ such that
\[\pi_i(x_1, \ldots, x_n) = (x_1, \ldots, \hat x_i, \ldots, x_n),\]
with $\hat x_i$ as usual denoting the omission of the $x_i$ term.
Analogous to the face and degeneracy identities for simplicial sets, these operators satisfy the following relations \cite[Section 4]{GrMa03} (it is also easy and illuminating to work these out on one's own):

\[
\begin{array}{rlc}
	\delta_j^\eta \delta_i^\varepsilon &= \delta_{i+1}^\varepsilon \delta_j^\eta, &j\leq i,\\
	\pi_i \pi_j &= \pi_j \pi_{i+1}, & j \leq i,\\
	\pi_j \delta^\varepsilon_i &=
	\begin{cases}
		\delta_{i-1}^\varepsilon \pi_j, \\
		\id,\\
		\delta_i^\varepsilon \pi_{j-1},
	\end{cases}
	&\begin{array}{lll}j<i, \\ j=i, \\ j>i. \end{array}
\end{array}
\]

For $v \in \vertices(\interval^n)$ all coordinates are bound -- that is, $v_{01} = \emptyset$.
Thus $v$ is determined by the partition of $\overline n$ into $v_0$ and $v_1$, so
we have a bijection from the set of vertices of $\interval^n$ to the power set $\mathcal P(\overline n)$ of $\overline n$, sending $v$ to $v_1$.
The inclusion relation in the power set induces a poset structure on $\vertices(\interval^n)$ given explicitly by
\begin{equation*}
	v = (\epsilon_1, \dots, \epsilon_n) \leq w = (\eta_1, \dots, \eta_n) \iff \forall i,\ \epsilon_i \leq \eta_i.
\end{equation*}
We will freely use the identification of these two posets, thinking of $\mathcal P(\overline n)$ as a combinatorial model for $\interval^n$ in the same way that one identifies the totally ordered set $[0,\dots, n]$ with the $n$-simplex $\Delta^n$ in the simplicial setting.
Note that face embedding maps induce order-preserving maps at the level of vertices.

An \textbf{interval subposet} of $\mathcal P(\overline n)$ is one of the form $[v, w] = \{u \in \mathcal P(\overline n)\ |\ v \leq u \leq w\}$ for a pair of vertices $v \leq w$.
This is precisely the set of vertices of the unique face $F$ of $\interval^n$ with $v$ as its initial vertex and $w$ as its terminal vertex.
This association determines a canonical bijection between faces of $\interval^n$ and such subposets; explicitly, to $[v, w]$ we associate the face $F$ defined by $F_\varepsilon = \{i \in \overline{n}\ |\ v_i = w_i = \varepsilon\}$ for $\varepsilon \in \{0, 1\}$.

The posets $\{\mathcal P(\overline n)\}_{n \geq 1}$ play the role for cubical complexes that finite totally ordered sets play for simplicial complexes.
Recall for comparison that an abstract ordered simplicial complex can be defined as a pair $(\vertices(X), X)$, where $X$ is a collection of subsets of the set $\vertices(X)$, called simplices, such that every singleton subset (vertex) is in $X$, every subset of a simplex (face) is again in $X$, and each simplex is equipped with a total order compatible with its faces.
We have the following cubical analogue.

\begin{definition}\label{D:cubical}
	A \textbf{cubical complex} $X$ is a collection $\{ \sigma \}$ of finite non-empty subsets of a set $\vertices(X)$, together with, for each $\sigma \in X$, a bijection $\iota_\sigma \colon \sigma \to \mathcal P(\overline n)$ for some $n$, such that:
	\begin{enumerate}
		\item For all $v \in \vertices(X)$, $\{v\} \in X$,
		\item For all $\sigma \in X$ and all $[u,w] \subset \mathcal P(\overline n)$ the set $\rho = \iota_\sigma^{-1}([u,w])$ is in $X$ and the following diagram commutes, with the two diagonal maps being order preserving:
		\begin{equation*}
			\begin{tikzcd} [row sep = tiny, column sep = small]
				\sigma \arrow[rr, "\iota_\sigma"] && \mathcal P(\overline n) \\
				& [-5pt] {[}u,w{]} \arrow[ur, hook] & \\
				\rho \arrow[uu, hook] \arrow[rr, "\iota_\rho"'] && \mathcal P(\overline m).
				\arrow[ul, "\cong"'] \arrow[uu, dashed]
			\end{tikzcd}
		\end{equation*}
	\end{enumerate}
	We refer to an element $\sigma \in X$ as a \textbf{cube} or \textbf{face} of $X$, refer to $\iota_\sigma \colon \sigma \to \mathcal P(\overline{n})$ as its \textbf{characteristic map},
	and refer to $n$ as its \textbf{dimension}.
	If $\rho \subseteq \sigma \in X$, we say that $\rho$ is a \textbf{face} of $\sigma$ in $X$, and this determines a poset structure on $X$ itself.
	We identify elements in $\vertices(X)$ with the singleton subsets in $X$, referring to them as vertices.
\end{definition}

In the definition, the role of the characteristic maps $\iota_\sigma \colon \sigma \to \mathcal P(\overline{n})$ is to endow each cube $\sigma$ with a poset structure on its vertices that mirrors the poset structure on the topological cube $\interval^n$ that we previously established by identifying the vertices of $\interval^n$ with $\mathcal P(\overline n)$.
The first condition then says that every vertex is a cube of the cubical complex, while the second says that every face of a cube is also a cube in the complex with its compatible subposet structure.
We also note that the definition guarantees that no two cubes of a cubical complex can share the same set of vertices, i.e.\ a cube is completely determined by its set of vertices; cf.\ \cref{F: cubical structure}.

In analogy with the usual terminology in the simplicial setting, one could call these ``ordered cubical complexes," but we will not need the unordered version.
Our definition sits between cubical sets \cite{jardine2002cubical} and cellular subsets of the cubical lattice of $\R^\infty$ \cite{kaczynski2006computational}, analogously to the way that abstract ordered simplicial complexes sit between simplicial sets and simplicial complexes.
\begin{comment}
	The following geometric realization construction makes our definition and the cubical lattice definition essentially equivalent.
\end{comment}

\begin{remark}
	In \cite{FMS-flows} we assumed $\vertices(X)$ to be a poset, but this extra condition was not used and is not necessary for what follows.
	It does, however, sometimes occur naturally, such as when a cubical complex is a subcomplex of a lattice, as will be the case in our construction below of cubulations of smooth manifolds.
\end{remark}

\noindent Given two cubical complexes $X$ and $Y$, their \textbf{product} is the cubical complex
\[
X \times Y = \{ \sigma_X \times \sigma_Y \mid \sigma_X \in X,\ \sigma_Y \in Y \},
\]
with vertex set $\vertices(X \times Y)$ and characteristic maps defined by
\[
\iota_{\sigma_X \times \sigma_Y} = \iota_{\sigma_X} \times \iota_{\sigma_Y} \colon \sigma_X \times \sigma_Y \to \mathcal{P}(\overline{n}) \times \mathcal{P}(\overline{m}) \cong \mathcal{P}(\overline{n + m}),
\]
where
\[
\mathcal{P}(\overline{n}) \times \mathcal{P}(\overline{m}) \cong \mathcal{P}(\overline{n + m}),
\]
is the canonical order-preserving bijection, which is compatible with the identification
\[
\vertices(\interval^n) \times \vertices(\interval^m) \cong \vertices(\interval^{n + m}).
\]

\subsection{Cubulations}

Let ${\tt Top}$ denote the category of topological spaces and continuous maps, and let ${\tt Cube}$ be the subcategory whose objects are the $n$-cubes, identified with $\interval^n$, and whose morphisms are face inclusions.
The poset of faces of a cubical complex $X$ also determines a category, and the characteristic maps of $X$ determine a functor from this poset category to $\mathtt{Cube}$.
We define the \textbf{geometric realization} $|X|$ of $X$ as the colimit of this functor; in other words, we glue topological cubes together according to the combinatorial data of the cubical complex $X$ in the evident way.
A \textbf{cubical structure} or \textbf{cubulation} on a space $S$ is a homeomorphism $h \colon |X| \to S$ for some cubical complex $X$.

\begin{comment}
	We abuse notation and write $h \circ \iota_{|\sigma|}$ simply as $\iota_\sigma$ for any $\sigma \in X$ when a cubical structure $h \colon |X| \to S$ is understood.
\end{comment}

A smooth cubulation is one for which the restriction of $h \colon |X| \to S$ to each cube is a smooth map of manifolds with corners.
For a given face of $F$ of $X$, we will also refer to the corresponding map $\interval^n \to S$ as the characteristic map of the face.
Smooth cubulations exist for any smooth manifold, as in the following construction of \cite{ShSh92}.

Start with a smooth triangulation (see for example \cite[Theorem 10.6]{MUNK66} for the existence of such).
Consider the cell complex that is dual to its barycentric subdivision.
Intersecting those dual cells with each simplex in the triangulation provides a subdivision of the simplex into cells that are linearly isomorphic to cubes.
Moreover, starting with an ordered triangulation -- obtained for example by taking a barycentric subdivision -- such a cubical decomposition embeds cellularly into the cubical lattice of $\R^\infty$, and thus it is the geometric realization of a cubical complex.
See \cite{ShSh92} for details.

Using the product of cubical complexes, it follows immediately that the product of cubulated manifolds is again a cubulated manifold.

\begin{figure}
	\input{auxy/torus.tex}
	\caption{The first cellular decomposition of a torus pictured above does not represent the geometric realization of a cubical complex, as each square has the same set of vertices.
		On the right, each square has been coherently identified with the standard square and has a unique set of vertices.
		Therefore, (B) depicts a cubical structure on the torus.}
	\label{F: cubical structure}
\end{figure}

\subsection{Cubical chains and cochains}\label{S: cubical cochains}

We can also define an ``algebraic realization" for a cubical complex in analogy to its geometric realization.
Let $K_*(\interval^1)$ be the usual cellular chain complex of the interval with integer coefficients.
Explicitly, $K_0(\interval^1)$ is generated by the vertices, which we write in this context as $[\underline{0}]$ and $[\underline{1}]$, and $K_1(\interval^1)$ is generated by the unique 1-dimensional face, denoted $[\underline{0},\underline{1}]$ in the interval subposet notation.
The boundary map is $\bd [\underline{0},\underline{1}] = [\underline{1}]-[\underline{0}]$.

Let $K_*(\interval^n) = K_*(\interval^1)^{ \otimes n}$, with differential defined by the graded Leibniz rule.
Given a face inclusion $\delta_i^{\varepsilon} \colon \interval^n \to \interval^{n+1}$ the natural chain map $K_*(\delta_i^{\varepsilon}) \colon K_*(\interval^1)^{ \otimes n} \to K_*(\interval^1)^{ \otimes n+1}$ is defined on basis elements by
\begin{equation*}
	x_1 \otimes \cdots \otimes x_n \mapsto
	x_1 \otimes \cdots \otimes [\underline{\varepsilon}] \otimes \cdots \otimes x_n.
\end{equation*}
Regarding a cubical complex $X$ as a functor to $\mathtt{Cube}$, we can compose it with the chain functor above to obtain a functor to chain complexes.
The complex of \textbf{cubical chains} of $X$, denoted $K_*(X)$, is defined to be the colimit of this composition.
As one would expect, in each degree it is a free abelian group generated by the cubes of that dimension, and its boundary homomorphism sends the
generator associated to a cube to a sum of generators associated to its codimension-one faces with appropriate signs.
Furtheremore, the functor of cubical chains is strongly monoidal in the sense that $K_*(X \times Y)$ is canonically isomorphic to $K_*(X) \otimes K_*(Y)$ for any pair of cubical complexes.
We will write $H_*(X)$ for $H_*(K_*(X))$, the cubical homology of $X$.

By abuse, we will use the same notation and terminology for an element in $X$, its geometric realization in $|X|$,
and the corresponding basis element in $K_*(X)$.
Most commonly we will write $F$ and refer simply to a ``face of $X$.''

We note that for each $\interval^n$ we have the ordered set $\{\e_1, \dots, \e_n\}$ where $\e_i = \frac{\bd\ }{\bd x_i}$.
For any face $F$ of $\interval^n$, the ordered subset $\beta_F = \{\e_i\ |\ i \in F_{01}\}$ defines the \textbf{canonical orientation} of $F$.
In forming the cubical complex $X$, these orientations are preserved, and so each face of $X$ carries an orientation.
These orientations are compatible with our standard generators of $K_*(X)$ in the sense that if we identify $[0,1]^{ \otimes k}$ with $\interval^k$ with its standard orientation then, in the boundary formula, $k-1$ faces appear with sign $1$ or $-1$ according to whether or not their standard orientations agree with the boundary orientation of $\interval^k$ as a manifold with corners.

The \textbf{cubical cochain complex} of $X$ (with $\Z$ coefficients) is the chain complex
\[
K^*(X) = \Hom_\Z(K_*(X), \Z).
\]
If $F$ is a face of $X$, and correspondingly a generator of $K_*(X)$, then we will write $F^*$ for the dual, i.e.\ the element of $K^*(X)$ such that $F^*(F) = 1$ and $F^*(E) = 0$ for all other faces $E\neq F$ of $X$.
We will use the convention as in \cite[Section 42]{Mun84} that
$$(dF^*)(\xi) = F^*(\bd \xi).$$
As discussed in \cite[Section 42]{Mun84} in the simplicial context, these formulas are sufficient to determine the coboundary operator on all of $K^*(X)$, thinking of elements of $K^*(X)$ as possibly infinite formal sums $\sum n_i F_i^*$.
We will write $H^*(X)$ for $H^*(K^*(X))$, the cubical cohomology of $X$.

\subsection{Comparing cubical and geometric homology}\label{S: cubical and geometric homology}

Suppose $h \colon |X| \to M$ is a smooth cubulation.
As the cubes of $X$ are compact oriented manifolds with corners, the composition of the inclusion of a cube into $X$ with the map $h$ gives an element of $PC_*^\Gamma(M)$ and hence an element of $C_*^\Gamma(M)$.
Furthermore, the boundary formula for cubes in $K_*(X)$ agrees with the geometric boundary formula.
So we obtain a chain map, in fact a subcomplex inclusion, $\mc J \colon K^X_*(M) \into C^\Gamma_*(M)$ with $K_*^X(M)$ canonically isomorphic to $K_*(X)$.
We show in \cref{T: cubical homology iso} that the homology of $K_*(X)$ is both the standard homology of $M$ and the geometric homology $M$.

Recall from \cref{S: homology is homology} the normalized singular cubical chain complex of $M$, denoted $NK_*(M)$, as well as the subcomplex $NK^{sm}_*(M)$ generated by smooth cubes.
The homology groups of each are isomorphic to the standard simplicial singular homology of $M$, for example by our work in \cref{S: homology is homology,S: smooth cubes}.
Furthermore, by \cref{T: hom iso map,P: singular smooth cubes}, there are quasi-isomorphisms $NK_*(M) \xleftarrow{\psi} NK^{sm}_*(M) \xr{\phi} C^\Gamma_*(M)$, the latter induced by observing that smooth singular cubes are elements of $PC^\Gamma_*(M)$ and that degenerate cubes are elements of $Q_*(M)$.

There is also a map $\eta: K_*(X) \to NK^{sm}_*(M)$ that takes each cube into its embedding into $M$.
Then $\mc J = \phi\eta \colon K_*(X) \to C^\Gamma_*(M)$.


\begin{theorem}\label{T: cubical homology iso}
	The map $\eta: K_*(X) \to NK^{sm}_*(M)$ is a chain homotopy equivalence, and the map $\mc J \colon K_*(X) \to C^\Gamma_*(M)$ induces an isomorphism of homology groups $H_*(K_*(X)) \to H_*^\Gamma(M)$.
\end{theorem}

\begin{proof}

	As $\phi \colon NK^{sm}_*(M) \to C^\Gamma_*(M)$ is a quasi-isomorphism by \cref{T: hom iso map}, it suffices to show that $\eta$ is a chain homotopy equivalence.
	In fact, as $NK^{sm}_*(M)$ is freely generated by the nondegenerate smooth singular cubes, $K_*(X)$ and $NK^{sm}_*(M)$ are both free chain complexes bounded below, so it suffices by \cite[Theorem 46.2]{Mun84} to show that $\eta$ induces homology isomorphisms.

	The proof is analogous to the proof of \cite[Proposition V.8.3]{Dol72}, which provides an isomorphism between simplicial and singular homology.

	Consider have the diagram
	\[
	\begin{tikzcd}
		H_*(K_*(X)) \arrow[r, "\eta_*"] \arrow[d, "\cong"] & H_*(NK^{sm}_*(M)) \arrow[r, "\psi_*", "\cong"'] & H_*(NK_*(M)) \\
		H_*(CW_*(M)) \arrow[rru, "\Theta", "\cong"', out=0, in=200] & &
	\end{tikzcd}
	\]
	in which $CW_*(M)$ is the CW chain complex of $M$ corresponding to the CW complex structure given by the cubulation and $\Theta$ is the standard isomorphism between CW homology and singular homology as in Dold \cite[Proposition V.1.9]{Dol72}.
	The isomorphism in Dold is developed using simplicial singular homology, but as simplicial singular and cubical singular homology are isomorphic, the argument there goes through identically using singular cubes.
	The map on the left is an isomorphism at the chain level as there is an evident isomorphism in this case between the cubical chain complex and the CW chain complex that takes an embedding of a $k$-cube to the corresponding generator of $CW_k(M) = H_k(X^k, X^{k-1})$ (where we assume the expression on the right is singular cubical homology).
	As in Dold, the map $\Theta$ takes a class in $H_k(CW_*(M))$ represented by a $k$-cycle $z$ in $CW_k(M)$ to the class in $H_k(NK_*(M))$ represented by a singular (cubical) cycle in $NK_k(M)$ that represents the same class as $z$ in $H_k(X^k,X^{k-1})$.
	But all cycles in the image of the vertical map of the diagram are already represented by singular cycles in $NK^{sm}_k(M)$, so the diagram commutes, and it follows that $\eta_*$ is an isomorphism.
\end{proof}

As a corollary of the proof, we have the following useful result concerning the cohomology groups of the complexes, which we obtain using the following definitions:
\begin{align*}
	NK^*(M)& \defeq \Hom(NK_*(M),\Z)\\
	NK_{sm}^*(M)& \defeq \Hom(NK^{sm}_*(M),\Z).
\end{align*}

\begin{corollary}
	The following maps on cohomology induced by restrictions are isomorphisms: $$H^*(NK^*(M)) \to H^*(NK_{sm}^*(M)) \to H^*(X).$$
\end{corollary}

\begin{proof}
	This follows from basic homological algebra \cite[Theorem 45.5]{Mun84} as $NK_*(M)$, $NK^{sm}_*(M)$, and $K_*(X)$ are all free chain complexes, observing that even though $NK_*(M)$ and $NK^{sm}_*(M)$ are defined by taking quotients of the groups of singular cubical chains $SK_*(M)$ and $SK^{sm}_*(M)$ by the subgroups of degenerate cubes, the degenerate cubes correspond to generators of $SK_*(M)$ and $SK^{sm}_*(M)$, and so each $NK_i(M)$ and $NK^{sm}_i(M)$ is freely generated by the nondegenerate, respectively nondegenerate and smooth, singular $i$-cubes.
\end{proof}

\subsection{Cubically transverse geometric cohomology}\label{S: transverse cochains}

In this section we consider the cochains on $M$ represented by maps $W \to M$ that are transverse to a given cubulation of $M$.

\begin{definition}\label{D: trans cube}
	Let $M$ be equipped with a smooth cubulation $|X| \to M$.
	We say that $r_W \colon W \to M$ is \textbf{transverse} to $X$ if $r_W \colon W \to M$ is transverse to each characteristic map of the cubulation.
	In particular, this implies by \cref{L: simple trans} that each induced $\bd^kW \to M$ is naively transverse to each face of the cubulation.
	If $r_W \colon W \to M$ is transverse to $X$ then the same is true for any $r_V \colon V \to M$ isomorphic to $r_W \colon W \to M$, and so we can define $PC^*_{\Gamma \pf X}(M)$ to be the subset of $PC^*_{\Gamma}(M)$ consisting of those precochains with reference maps transverse to $X$.

	We let $Q^*_{\Gamma \pf X}(M) = PC_{\Gamma \pf X}^*(M) \cap Q^*(M)$ and note that the equivalence relation of \cref{L: cancel Q} descends to an equivalence relation on $PC_{\Gamma \pf X}^*(M)$ such that $V\sim W$ if and only if $V \sqcup -W \in Q^*_{\Gamma \pf X}(M)$.
	The \textbf{geometric cochains of $M$ transverse to $X$}, denoted $C_{\Gamma \pf X}^*(M)$, are the equivalence classes in $PC_{\Gamma \pf X}^*(M)$.
	The set $C_{\Gamma \pf X}^*(M)$ is a chain complex under the operation $\sqcup$ and with boundary map $\bd$.
	If $V, W \in PC_{\Gamma \pf X}^*(M)$, then $V \sqcup -W \in Q^*_{\Gamma \pf X}(M)$ if and only if as elements of $PC_\Gamma^*(M)$ we have $V \sqcup -W \in Q^*(M)$, so $V$ and $W$ represent the same element of $C_{\Gamma \pf X}^*(M)$ if and only if they represent the same element of $C^*_\Gamma(M)$.
	Thus $C_{\Gamma \pf X}^*(M)$ is a subcomplex of $C_\Gamma^*(M)$.
	The \textbf{geometric cohomology transverse to $X$} is $H_{\Gamma \pf X}^*(M) \defeq H^*(C_{\Gamma \pf X}^*(M))$.

	When the specific cubulation $X$ is understood, we sometimes simplify the notation to $PC_{\Gamma\pf}^*(M)$, $C_{\Gamma\pf}^*(M)$, and $H_{\Gamma\pf}^*(M)$.
\end{definition}

The proof of \cref{L: co/chains well defined} continues to hold for transverse cochains, and so $r_W \colon W \to M$ represents $0$ in $C^*_{\Gamma \pf X}(M)$ if and only if it is in $Q^*_{\Gamma \pf X}(M)$.
Therefore, the evident map $C^*_{\Gamma \pf X}(M) \to C^*_\Gamma(M)$, which takes the element of $C^*_{\Gamma \pf X}(M)$ represented by $r_W \colon W \to M$ to the element of $C^*_\Gamma(M)$ represented by the same map, is a monomorphism of chain complexes, for such an $r_W$ is transverse to $X$ by definition and if it is also in $Q^*(M)$ then it is in $Q^*_{\Gamma \pf X}(M)$.
Thus we will think of $C^*_{\Gamma \pf X}(M)$ as a subcomplex of $C^*_\Gamma(M)$.
A key technical result, which will take the remainder of this section to prove,
is that this inclusion induces a cohomology isomorphism.
In other words, the cochains that are transverse to $X$ are sufficient to compute the cohomology of $M$.

\begin{theorem}\label{T: transverse complex}
	The inclusion $C^*_{\Gamma \pf X}(M) \into C^*_\Gamma(M)$ is a quasi-isomorphism.
\end{theorem}

To show that the inclusion $C^*_{\Gamma \pf X}(M) \into C^*_\Gamma(M)$ is a quasi-isomorphism, it will be necessary to consider the following scenario.
Suppose we have a map $r_V \colon V \to M$ with $V$ a manifold with corners and $M$ a manifold with a cubulation.
Let $\bd V = W$, and suppose $W$ is already transverse to the cubulation.
We will construct a homotopy $h \colon V \times I \to M$ such that $g(-,0) = r_V$, $g(-,1)$ is transverse to the cubulation, and the restriction of $h$ to $W \times I$ is transverse to the cubulation. However, as noted at the end of \cref{S: covariant functoriality}, such a homotopy might not preserve cohomology classes, as we will need below. So we must instead use the universal homotopies of \cref{D: universal homotopy,P: universal homotopy}.


The technique for constructing such homotopies will be modeled on a variety of results in \cite{GuPo74}.
We use the Transversality Theorem and Transversality Homotopy Theorem of \cite[Section 2.3]{GuPo74} as stated.
However, for the Stability Theorem of \cite[Section 1.6]{GuPo74} we will provide details of the proof because the proof is only sketched in \cite{GuPo74} and we will need the result to be generalized in several ways.
Also, the Stability Theorem was not stated correct in early printings of \cite{GuPo74}, where the requirement that the submanifold of the target be a closed set was omitted\footnote{As stated in early printings of \cite{GuPo74}, the claim was that if $f \colon X \to Y$ is transverse to any submanifold $Z$ of $Y$ then this property is stable under small homotopies of $f$; more specifically that if $f_t:X \times I \to Y$ is a homotopy with $f_0$ transverse to $Z$ then there is an $\epsilon>0$ such that $f_t$ is transverse to $Z$ for all $t\in[0,\epsilon)$.
	Here is a counterexample:

	In the plane $\R^2$, let $Z = \{(x,y)|y = x^2, x\neq 0\}$ and consider maps $g_t: \R \to \R^2$ with
	$g_t(x) = (x,t^2+2t(x-t))$.
	For each fixed $t$, the image is the line given by $y-t^2 = 2t(x-t)$, which has slope $2t$ and passes through the point $(t,t^2)$.
	So the map $g_0$ embeds $\R$ as the x-axis, and as the image does not intersect $Z$, the map $g_0$ is transverse to $Z$.
	But for all $t\neq 0$, $g_t$ takes $\R$ to a line that is tangent to $Z$, and so $g_t$ is not transverse to $Z$ for $t\neq 0$, violating the Stability Theorem as stated on page 35 of \cite{GuPo74}.

	The error in the original proof comes from considering only what happens in neighborhoods of points $x$ such that $f(x) \in Z$ but not points $x$ with $f(x)\notin Z$.
	As we can see, the claim breaks down when $f(x)\notin Z$ but every neighborhood of $(x,0)$ in $X \times I$ has a point with image in $Z$.
	However, this can be avoided if $Z$ is a closed set in $Y$, as is the case for the statement of the theorem in later printings of \cite{GuPo74}.}.
The needed versions of these results is established in the following proposition:

\begin{proposition}\label{P: ball stability}
	Suppose $r_V \colon V \to M$ is a proper map from a manifold with corners to a cubulated manifold without boundary.
	Then there is a proper homotopy $H \colon M \times I \to M$ such that $H(-,0) = \id_M$ and $H(-,1) r_V \colon V \to M$ is transverse to the cubulation.
	In other words, there is a proper universal homotopy from $r_V$ to a map that is transverse to the cubulation.

	Furthermore, given another proper map $r_W \colon W \to M$ that is transverse to the cubulation, we can choose the homotopy $H$ above so that also the resulting universal proper homotopy of $W$ given by $W \times I \xr{r_W \times \id_I} M \times I \xr{H} M$ is transverse to the cubulation.
\end{proposition}

Before proving the proposition, which is somewhat technical, we use it to prove \cref{T: transverse complex}, which states that $H^*(C^*_{\Gamma \pf X}(M)) \to H^*(C_\Gamma^*(M))$ is an isomorphism.

\begin{proof}[Proof of \cref{T: transverse complex}]
	The idea of the argument that $H^*(C^*_{\Gamma \pf X}(M)) \to H^*(C_\Gamma^*(M))$ is a surjection is contained already in the proof of \cite[Lemma 15]{Lipy14}, which involves constructing a homotopy to move a cycle into transverse position.
	We elaborate upon that argument.

	Suppose $\uV \in C_\Gamma^*(M)$ is a cocycle represented by $r_V \colon V \to M$.
	By \cref{P: ball stability}, there is a proper universal homotopy $h \colon V \times I \to M$ from $r_V$ to $H(-,1)r_{V} \colon V \to M$ and this latter map is transverse to the cubulation.
	Let us call the transverse map $r_{V'} \colon V' \to M$ with $V' \cong V$.
	By \cref{C: homotopy}, $r_V$ and $r_{V'}$ represent the same cohomology class in $H^*_{\Gamma}(M)$, but the class represented by $r_{V'}$ is in the image of $H^*(C^*_{\Gamma \pf X}(M))$.

	For injectivity, suppose $W \in PC^*_{\Gamma \pf X}(M)$ is transverse to the cubulation and represents zero in $H^*(C_\Gamma^*(M))$.
	Then by definition there is a $V \in PC^*_\Gamma(M)$ with $\bd V \sqcup -W \in Q^*(M)$.
	By \cref{P: ball stability}, there is a proper homotopy $H \colon M \times I \to M$ such that both $H(-,1)r_V$ and $H\circ (r_W \times \id_I)$ are transverse to the cubulation.
	Let $V'$ be the precochain $V \xr{H(-,1)r_V} M$, let $W'$ be the precochain $W \xr{H(-,1)r_W} M$, and let $Y$ be the precochain $W \times I \xr{H\circ (r_W \times \id_I)} M$.
	Let $Z$ be the precochain $V' \sqcup -Y$, which is transverse to the cubulation.
	We note that $\bd V' \sqcup -W'$ is the image of $\bd V \sqcup -W$ after composing with $H(-,1)$, and so it is in $Q^*(M)$ by \cref{L: Q preservation}, using that we can co-orient $H$ and $H(-,1)$ as in \cref{S: co-oriented homotopy}.
	Also as in \cref{S: co-oriented homotopy}, for the co-oriented case we have $\bd Y = W' \sqcup -W \sqcup B$, where $B$ is the pre(co)chain $\bd W \times I \xr{H\circ (r_{\bd V} \times \id_I)} M$ (cf. the proof of \cref{C: homotopy}).
	Continuing in the co-oriented case, we now compute
	\begin{align*}
		\bd Z \sqcup -W &= \bd V' \sqcup -\bd Y \sqcup -W\\
		&= \bd V' \sqcup -(W' \sqcup -W \sqcup B) \sqcup -W\\
		&= \bd V' \sqcup -W' \sqcup W \sqcup -W \sqcup -B.
	\end{align*}
	We have already noted $\bd V' \sqcup -W' \in Q^*(M)$ and $W \sqcup -W$ is trivial.
	Since $W$ represents a cycle, $\bd W \in Q^*(M)$ and hence $B \in Q^*(M)$ by \cref{L: dessicated homotopy}.
	So $\bd Z \sqcup -W \in Q^*(M)$ and $Z$ is transverse to the cubulation, which tells us that $W$ represents $0$ in $H^*_{\Gamma \pf X}(M)$.
\end{proof}

\begin{comment}
	For injectivity, suppose $W \in PC^*_{\Gamma \pf X}(M)$ is transverse to the cubulation and represents zero in $H^*(C_\Gamma^*(M))$.
	Then by definition there is a $V \in PC^*_\Gamma(M)$ with $\bd V = W+T$ for some
	$T \in Q^*(M)$.
	By \cref{P: ball stability} there is a proper universal homotopy $h \colon V \times I \to M$ such that $h(-,1)$ and $h \circ (i_{W} \times \id)$ are both transverse to the cubulation.
	Let $V', W',T' \in PC^*_\Gamma(M)$ be $W$, $V$, and $T$ but with reference maps given respectively by $h(-,1)$, $h(-,1)i_W$, and $h(-,1)i_T$, where $i_W \colon W \to V$ and $i_T \colon T \to V$ are the boundary inclusion maps restricted to the components of $W$ and $T$, respectively.
	As $h \circ (i_{W} \times \id)$ is transverse to the cubulation, $W$ and $W'$ represent the same element of $H^*_{\Gamma \pf X}(M)$ by arguments analogous to the proof of \cref{C: homotopy}.
	But we also have $\bd V' = W'+T'$ with $V'$ in $C^*_{\Gamma \pf X}(M)$ and, by \cref{L: Q preservation}, $T' \in Q^*(M)$.
	So $W'$ represents $0 \in H^*(C^*_{\Gamma \pf X}(M))$.
\end{comment}


It remains to prove \cref{P: ball stability}, which will require the following technical lemma that is also useful below in the proof of \cref{T: intersection qi}.

\begin{lemma}\label{L: minimizer}
	Let $M$ be a manifold without boundary, and let $\mc U = \{U_j\}$ be a locally finite open cover such that each $\bar U_j$ is compact.
	Suppose given $\varepsilon_j>0$ for each $j$.
	Then there exists a smooth function $\phi \colon M \to \R$ such that $0<\phi(x)<\varepsilon_j$ if $x \in \bar U_j$.
\end{lemma}

\begin{proof}
	Let $\eta_j = \min\{\varepsilon_k \mid \bar U_j \cap \bar U_k\neq \emptyset\}$.
	By the local finiteness and compactness conditions, $\{k \mid \bar U_j \cap \bar U_k\neq \emptyset\}$ is a finite set and so the $\eta_j$ are well defined.
	Let $\{\psi_j\}$ be a partition of unity subordinate to $\mc U$ and let $\phi_1 = \sum \eta_j\psi_j$.
	For any $x \in M$, this sum is positive.
	If $x \in \bar U_j$ then $\phi_1(x) = \sum_{\{k \mid \bar U_j \cap \bar U_k\neq \emptyset\}} \eta_k\psi_k$.
	But for any such $k$, we have $\eta_k \leq \varepsilon_j$.
	Thus $\phi_1(x) \leq \varepsilon_j$.
	Now take $\phi = \frac{1}{2}\phi_1$.
\end{proof}

We can now prove \cref{P: ball stability}.
In the following $D^N$ is the open unit ball in $\R^N$ and, more generally, $D^N_r$ is the open ball of radius $r$.

\begin{proof}[Proof of \cref{P: ball stability}]
	We begin with the case that $W$ is compact, and then we will show how to use the arguments of the compact case to obtain the general case.
	We first construct a map $F \colon M \times D^N \to M$, for some $N$, such that

	\begin{enumerate}
		\item $F(-,0) = \id \colon M \to M$,
		\item for almost all $s \in D^N$ the composition $V \xr{r_V} M \xr{F(-,s)}M$ is transverse to the cubulation,
		\item there is a ball neighborhood $D_r^N$ of $0$ in $D^N$ such that for all $s \in D_r^N$ the composition $W \xr{r_W} M \xr{F(-,s)}M$ is transverse to the cubulation.
	\end{enumerate}

	This will suffice to provide the transversality required in the $W$ compact case as then we can let $s_0$ be any point in $D_r^N$ such that the composition $V \xr{r_V} M \xr{F(-,s_0)}M$ is transverse to the cubulation and define $H(-,t) = F(-,ts_0)$.
	Then $H(-,0) = \id_M$ since $F(-,0) = \id$.
	We will have $H(-,1) r_V \colon V \to M$ transverse to the cubulation by our choice of $s_0$.
	Finally, as $ts_0 \in D_r^N$ for all $t \in I$, each $F(-,ts_0)r_W$ is transverse to the cubulation, which then implies that $H \circ (r_{W} \times \id)$ is transverse to it as well.
	This does not provide the properness of $H$, but we consider that below.
	\begin{comment}Furthermore, for $V$ compact any map and homotopy are proper, and this homotopy is universal as it can be decomposed into $r_V \colon V \times I \to M \times I$ and the homotopy $M \times I \to M$ taking $(z,t)$ to $F(z,ts_0)$.
	\end{comment}

	The construction of $F$ is a small variation of the construction in the Transversality Homotopy Theorem of \cite[Section 2.3]{GuPo74}:
	Let $M_\epsilon$ be an $\epsilon$-neighborhood of $M$ in some $\R^N$ in the sense of the $\epsilon$-Neighborhood Theorem of \cite[Section 2.3]{GuPo74}; in particular,
	$M_\epsilon$ is an $\epsilon$-neighborhood of a proper embedding of $M$ into $\R^N$ that possesses a submersion $\pi \colon M_\epsilon \to M$.
	We may also assume $\epsilon$ is a bounded function.
	If $M$ is not compact, then $\epsilon$ is a smooth bounded positive function of $M$ and $M_\epsilon = \{z \in \R^N \mid |z-y|<\epsilon(y) \text{ for some }y \in M\}$.
	Let $f \colon M \times D^N \to M_\epsilon$ be given by $f(y, s) = y + \eta(y) s$, where $\eta \colon M \to \R$ is a smooth function such that $0 < \eta(y) < \epsilon(y)$ for all $y \in M$.
	As $\eta > 0$, this is clearly a submersion (onto its image) at all points.
	We let $F \colon M \times D^N \to M$ be the composition $M \times D^N \xr{f}M_\epsilon \xr{\pi}M$.
	Furthermore, the map $\ms F \colon V \times D^N \to M$ given by the composition $$V \times D^N \xr{r_V \times \id} M \times D^N \xr{F} M$$ as well as all the restrictions $\ms F|_{S^k(V)}$
	are submersions.
	In particular, each $\ms F|_{S^k(V)}$ is transverse to any submanifold of $M$, so it follows by the Transversality Theorem of \cite[Section 2.3]{GuPo74} that for any fixed submanifold $Z$ of $M$, each $\ms F|_{S^k(V)}(-,s)$ is transverse to $Z$ for almost all $s \in D^N$.
	In particular, we may take $Z$ to be the interior of any cube $E$ (of any dimension) of the cubulation.
	There are countably many cubes in the cubulation of $M$ and finitely many manifolds $S^k(V)$.
	As the countable union of measure zero sets has measure zero, for almost all $s \in D^N$ we have for all $k$ that $\ms F|_{S^k(V)}(-,s) = F(-,s)r_V|_{S^k(V)}$ is transverse to all cubical faces.

	We now show how to ensure $H$ is proper.
	We consider $M$ endowed with the the distance function $|\cdot|$ obtained by restricting the standard distance function on $\R^N$ to $M$.
	The projection $p \colon M \times I \to M$ is proper, and by
	\cref{L: nearby proper homotopy}, there is a continuous function $\varepsilon \colon M \times I \to (0,\infty)$ such that if $H \colon M \times I \to M$ satisfies $|p(y,t)-H(y,t)| < \varepsilon(y,t)$ for all $(y,t) \in M \times I$, then $H$ is proper.
	By essentially the same computation performed in the proof of \cref{T: basic trans},
	$$|p(y,t)-H(y,t)| = |y-H(y,t)| = |y - \pi(y + \eta(y) ts_0)| < 2 \eta(y).$$
	So for $H$ to be proper, it suffices to have $\eta(y) < \varepsilon(y,t)/2$ for all $(y,t) \in M \times I$.
	But if this is not already the case, we can simply replace $\eta$ in the above definition of $f$ with an $\eta \colon M \to (0,\infty)$ such that $\eta(y) < \min\{\epsilon(y), \min\{\varepsilon(y,t)/2 \mid t \in I\}\}$ for all $y$, analogously to the construction in the proof of \cref{T: basic trans}.
	Such an $\eta$ can be found by considering a locally finite open cover $\mc U = \{U_j\}$ of $M$ such that each $\bar U_j$ is compact.
	Then $\min\{\epsilon(y) \mid y \in \bar U_j\}$ and $\min\{\varepsilon(y,t)/2 \mid (y,t) \in \bar U_j \times I\}$ are both defined and positive as $\bar U_j$ and $\bar U_j \times I$ are compact and $\epsilon$ and $\varepsilon$ are both positive continuous functions.
	Now choose $b_j > 0$ such that $b_j$ is less than the minimum of these two minima for each $j$, and then apply \cref{L: minimizer}.

	It remains in the compact $W$ setting to show that if we are given compact $W$ with $r_W \colon W \to M$ transverse to the cubulation then $F(-,s)r_W$ is transverse to the cubulation for all $s$ in some neighborhood $D_r^N$ of $0$ in $D^N$.
	It is here that we need to generalize the Stability Theorem of \cite[Section 1.6]{GuPo74}.
	As the Stability Theorem is not necessarily true when the manifolds involved are not closed submanifolds, compact, or controlled in some other way, it is more convenient here to work with the closed cubical faces of the cubulation and with $\bd^kW$ rather than $S^k(W)$.
	We recall that by \cref{L: simple trans}, to prove that two maps of manifolds with corners are transverse it is sufficient to show that their compositions with all pairs of boundary inclusions are naively transverse (see \cref{D: naive transversality}).

	Let $\Upsilon_k$ denote the composition $$\Upsilon_k \colon \bd^kW \times D^N \xr{i_{\bd^ kW} \times \id_{D^N}} W \times D^N \xr{r_W \times \id_{D^N} } M \times D^N \xr{F} M.$$
	We provide the details primarily for $\Upsilon_0$, with $\bd^0 W$ being $W$ itself, the other cases being analogous.


	Let $E$ be a (closed) face of the cubulation.
	Recall that $F(-,0) = \id_M$, so $\Upsilon_0(-,0) = r_W$ is transverse to the cubulation.
	Thus for any $x \in W$, either $r_W(x)\notin E$ or $r_W$ is (naively) transverse to $E$ at $r_W(x)$.
	In the former case, as $E$ is closed, there is an open neighborhood $A_x$ of $(x,0) \in W \times D^N$ such that $\Upsilon_0(A_x) \cap E = \emptyset$.
	Now suppose that $r_W(x) \in E$ and is transverse there.
	By appealing to charts, we can suppose without loss of generality (at least locally in neighborhoods of $x$ and $r_W(x)$) that $M = \R_j^m$ for some $j$ with $m = \dim(M)$ and $x = 0$ and that $E = \{(y_1,\ldots,y_m) \mid y_i\geq 0\text{ for } i \leq \dim E\text{ and } y_i = 0 \text{ for } i>\dim(E)\}$.
	The transversality assumption means that the composition of $D_xr_W \colon T_xW \to T_{r_W(x)}M$ with the projection to the last $m-\dim(E)$ coordinates is a linear surjection.
	As this is an open condition on the Jacobian matrix of $r_W$ at $x$, it follows again that there is an open neighborhood $A_x$ of $(x,0) \in W \times D^N$ such that for each $(x',s)$ in the neighborhood $\Upsilon_0(-,s)$ is transverse to $E$ at $x'$ (it is possible that $\Upsilon_0(x',s)$ no longer intersects $E$, but this is fine).
	Taking the union of the $A_x$ over all $x \in W$ gives a neighborhood $B_E$ of $W \times 0$ in $W \times D^N$, and by the Tube Lemma, as $W$ is compact there is a neighborhood of $W \times 0$ of the form $W \times U_E \subset B_E$.
	For each $s \in U_E$, we have $\Upsilon_0(-,s)$ transverse to $E$.
	Now let $D^N_{1/2}$ be the open ball of radius $1/2$ and $\bar D^N_{1/2}$ its closure.
	As $W \times \bar D^N_{1/2}$ is compact, its image under $\Upsilon_0$ can intersect only a finite number of faces of the cubulation of $M$; call this collection $\mc E$.
	Then let $U_0$ be the finite intersection $U_0 = D^N_{1/2} \cap \bigcap_{E\in\mc E} U_E$.
	Then $W \times U_0 \subset W \times D^N$ is a neighborhood of $W \times 0$ on which $\Upsilon_0(-,s)$ is transverse to every cubical face that its image intersects.
	Let $U_k$ be defined similarly for each $k\geq 1$ using $\bd^kW$ in place of $W$ and $\Upsilon_k$ in place of $\Upsilon_0$.
	As $W$ has finite depth, $U = \cap U_k$ is a neighborhood of $0$ in $D^N$.
	Let $r>0$ be such that $D^N_r \subset U$.
	Then for every $s \in D^N_r$ we have $\Upsilon_k(-,s) \colon \bd^kW \to M$ transverse to all $E$ for all $k$ as required.

	This completes the proof of the proposition for $W$ compact.

	Next suppose that $W$ is no longer necessarily compact.
	We show how to apply and extend the preceding arguments.
	We will define a new homotopy $\hat H \colon M \times I \to M$ with the desired properties of the proposition.

	To begin we construct $F \colon M \times I \to M$ exactly as above, as its definition did not depend on the compactness of $W$.
	Let $K \subset W$ be compact and $E$ be a closed cube.
	Taking the union of the $A_x$ as defined above over all $x \in K$ and intersecting with $K \times D^N$ gives an open neighborhood $B_E$ of $K \times 0$ in $K \times D^N$, such that
	$\Upsilon_0(-,s) \colon W \to M$ is transverse to $E$ at all $x \in K$.
	Furthermore, as $K \times \bar D^N_{1/2}$ is compact, its image under $\Upsilon_0$ can intersect only a finite number of faces of the cubulation of $M$, so again by applying the tube lemma and then intersecting tubular neighborhoods, we find an open ball $D_{r,K}^N \subset D^N$ centered at $0$ such that for all $x \in K$ and $s \in D_{r,K}^N$ we have $\Upsilon_0(-,s)$ transverse to the cubulation at $x$.
	As the maps $\bd^kW \into W$ for $k\geq 1$ are all proper, we can similarly find $D_{r,K}^N$ so that for all $s \in D_{r,K}^N$ and all $k\geq 0$, we have $\Upsilon_k(-,s) \colon \bd^kW \to M$ transverse to the cubulation at any $x \in \bd^{k}W$ whose image in $W$ is in $K$.

	Let $\{\mc U_j\}$ be a locally finite covering of $M$ such that each $\bar{\mc U_j}$ is compact.
	As $r_W$ is proper, each $r^{-1}_W(\bar {\mc U_j})$ is compact in $W$.
	Proceeding as just above with $r_W^{-1}(\bar U_j)$ in place of $K$, we can find for each $j$ an $\varepsilon_{j,0}$ with $0 < \varepsilon_{j,0} \leq 1$ so that for every $s \in D^N_{\varepsilon_{j,0}}$ we have $\Upsilon_0(-,s)$ transverse to all cubical faces of $M$ at every $x \in r^{-1}_W(\bar {\mc U_j})$.
	Analogously, we have $\varepsilon_{j,k}$ for all $k\geq 1$ using $(r_{\bd^k W})^{-1}(\bar {\mc U_j})$.
	Let $\varepsilon_j = \min\{\varepsilon_{j,k} \mid k\geq 0\}$.
	These minima exist as $W$ has finite depth.

	Now, using \cref{L: minimizer}, we choose a smooth function $\phi \colon M \to \R$ such that for all $y \in M$ we have $0<\phi(y)<\epsilon_j$ if $y \in \bar{\mc U_j}$.
	Let $M\times_\phi D^N = \{(y,s) \in M \times D^N \mid |s|<\phi(y)\}$.
	By our construction, $\Upsilon_k(-,s) \colon \bd^{k}W \to M$ is transverse to the cubulation at each $x$ such that $(x,s)\in(r_{\bd^{k}W} \times \id)^{-1}(M\times_\phi D^N) = \{(x,s) \in \bd^{k}W \times D^N \mid |s|<\phi(r_{\bd^kW}(x))\}$.
	Unfortunately, however, while $M\times_\phi D^N$ is a neighborhood of $M \times 0$ in $M \times D^N$, there is not necessarily a $U \in D^M$ so that $M \times U \subset M\times_\phi D^M$.
	Thus,
	we cannot construct $H$ from $F$ as above using a fixed $s_0$ as there may be no single $s_0\neq 0$ so that $W \times s_0 \subset M\times_\phi D^N$.

	To account for this, we modify our functions above as follows: Let $\hat f \colon M \times D^N \to M_\epsilon$ be given by $\hat f(y, s) = y + \phi(y) \eta(y) s$; as $\phi(y)\eta(y)>0$, this is again a submersion onto its image at all points.
	Let $\hat F \colon M \times D^N \to M$ be the composition $M \times D^N \xr{\hat f}M_\epsilon \xr{\pi}M$, and let $\hat \Upsilon_k$ be the composition $\bd^kW \times D^N \xr{r_{\bd^kW} \times \id}M \times D^N \xr{\hat F} M$ for $k\geq 0$.
	Once again by the Transversality Theorem of \cite[Section 2.3]{GuPo74}, for almost all $s \in D^N$ we have $V \xr{r_V} M \xr{\hat F(-,s)} M$ transverse to all cubical faces of $M$.
	Letting $s_0 \neq 0$ be any such point\footnote{If $s_0 = 0$ satisfies the conditions, we can finish immediately by letting $H$ be the constant homotopy.} we define $\hat H \colon M \times I \to M$ by $\hat H(x,t) = \hat F(x,ts_0)$, and we claim that this $\hat H$ satisfies the conditions required for the proposition.

	The map $\hat H$ is proper again by \cref{L: nearby proper homotopy} because $\phi(y) \eta(y) \leq \eta(y)$.
	The conditions of the proposition for $V$ follow immediately from the construction.
	It remains to verify that each $\hat h_k \defeq \hat H \circ (r_{\bd^k W} \times \id_I) \colon \bd^k W \times I \to M$ is transverse to the cubulation.
	Again, we focus primarily on $\hat h_0$.

	\begin{comment}
		Note: we are not claiming an analogue of the third condition above holds for $\hat F$, nor do we need to.
		As we already know from the second condition of the proposition that $\hat h(-,1)$ is transverse to the cubulation and from the hypotheses that $\hat h(-,0)$ is transverse to the cubulation on $W$, it suffices to demonstrated transversality to the cubulation on the restriction of $\hat h$ to $W \times (0,1)$.
	\end{comment}

	We begin by observing that for $(x,t) \in W \times I$ we can write $\hat h_0(x,t) \in M$ explicitly as
	$$\hat h_0(x,t) = \pi(r_W(x)+\phi(r_W(x))\eta(r_W(x))ts_0).$$
	So, alternatively, we can observe that $\hat h_0$ is the composition
	\begin{equation}\label{E: alt hat h}
		W \times I \xr{\Phi} W \times I \xhookrightarrow{\Psi} W \times D^N \xr{r_W \times \id} M \times D^N \xr{F} M,
	\end{equation}
	with $\Phi(x,t) = (x,\phi(r_W(x))t)$, $\Psi(x,t) = (x,ts_0)$, and noting that on the right we do mean our original $F$ and not $\hat F$.

	The first map $\Phi$ is a diffeomorphism onto its image, which is a neighborhood of $W \times 0$ in $W \times I$, and the map $\Psi$ embeds this into $W \times D^N$ by a product map that is constant in the $W$ direction and nontrivial linear in the second factor.
	The composition of the last two maps is just our earlier map $\Upsilon_0$.
	By construction, the map $r_W \times \id$ now takes the image of $\Psi\Phi$ into $M\times_\phi D^N$, and so at each point $(z,s)$ in the image of $\Psi\Phi$ if we fix $s$ and consider $\Upsilon_0(-,s)$ we get by construction a map on $W$ that is transverse at $z$ to the cubulation of $M$.
	Let $(x,t) \in W \times I$, let $\Psi \Phi(x,t) = (z,s)$, and let $\R s_0$ denote the line in $\R^N = T_sD^N$ spanned by the position vector of $s_0$.
	As $\Phi$ is a diffeomorphism onto its image and $\Psi$ is an embedding that is the identity with respect to $W$ and nontrivial linear on $I$, we see
	\begin{comment}
		$\Psi\Phi$ takes a neighborhood of any $(x,t) \in W \times [0,1]$ to a neighborhood of its image in $W \times \R s_0$, where $\R s_0$ is the line in $\R^N$ spanned by $s_0$.
	\end{comment}
	that the derivative of $\Psi\Phi$ maps the tangent space $T_{(x,t)}(W \times [0,1])$ onto $ T_zW \times \R s_0 \subset T_{(z,s)}(W \times D^N)$.
	In particular, this image contains $T_zW \times 0$, and by construction $D\Upsilon_0$ takes $T_zW \times 0$ to a tangent subspace in $M$ at $\hat h_0(x,t)$ that is transverse to the tangent space there of any closed face of the cubulation containing $\hat h_0(x,t)$.
	The same holds for $k>0$ replacing $W$ with $\bd^{k}W$ in \eqref{E: alt hat h} and $r_W$ with $r_{\bd^{k}W}$.
	So we see that $\hat H$ satisfies all the requirements of the proposition.
\end{proof}

\subsection{The intersection map and the isomorphism between cubical and geometric cohomology}\label{S: intersection map}

To define the intersection map, we introduce an augmentation map as in singular homology theory.
For this we first need a quick lemma.

\begin{lemma}\label{L: Q0}
	If $W \in Q_0(M)$, then $W$ has the same number of positively and negatively oriented points.
\end{lemma}

\begin{proof}
	As elements of $PC_0^\Gamma(M)$ cannot be degenerate, if $W \in Q_0(M)$ then $W$ must be trivial, and so there is an orientation-reversing diffeomorphism $\rho$ of $W$ such that $r_W\rho = r_W$.
	But a compact $0$-manifold has an orientation-reversing diffeomorphism if and only there are the same number of points with each orientation.
\end{proof}

\begin{definition}\label{D: aug}
	We define the \textbf{augmentation map} $\aug \colon PC^\Gamma_0(M) \to \Z$ as follows: If $W \in PC^\Gamma_0(M)$, then $W$ is the disjoint union of a finite number of points, each with orientation denoted $1$ or $-1$.
	We let $\aug(W)$ be the sum of the orientations of the points in $W$, interpreting $1$ and $-1$ as integers.
	By \cref{L: Q0}, an element of $PC^\Gamma_0(M)$ can be in $Q_0(M)$ only if this sum is $0$, so the augmentation descends to a homomorphism $\aug \colon C^\Gamma_0(M) \to \Z$.
	Furthermore, if $W \in PC_1^\Gamma(M)$ then $\aug(\bd W) = 0$, so $\aug$ further descends to a homomorphism $\aug \colon H_0^\Gamma(M) \to \Z$.
\end{definition}

Later, we will construct in general a partially-defined intersection map $C^*_\Gamma(M) \otimes C_*^\Gamma(M) \to C_*^\Gamma(M)$.
In general, this is delicate, as geometric chains and cochains do not have fixed representatives.
However, at the moment we do not need this full generality to define the intersection map we will need to compare geometric cohomology and cubical cohomology.
This is reflected in the following more limited definition:

\begin{definition}\label{D: intersection number}
	Suppose $M$ is an $m$-manifold without boundary and $W \in PC_\Gamma^i(M)$ and $N \in PC_{i}^\Gamma(M)$ are transverse.
	We define the \textit{intersection number} $I_M(W,N)$ (or simply $I(W,N)$ if $M$ is clear from context) by $$I_M(W,N) = \aug(W \times_M N),$$ with $W \times_M N$ as defined in \cref{D: PC products}.
\end{definition}

We observe that this definition makes sense as $W$ and $N$ are transverse with complementary dimensions and $W \times_M N$ is an element of $PC_0^\Gamma(M)$.
In fact, in this case in order for transversality to hold the maps $r_W \colon W \to M$ and $r_N \colon N \to M$ must have full rank at each $x \in W$ and $y \in N$ such that $r_W(x) = r_N(y)$.
As having full rank is an open condition, the maps will also have full rank on neighborhoods of these points.
In particular, by the Implicit Function Theorem, they must be immersions on neighborhoods of these points.
So, locally, the orientation of $N$ determines an orientation of $T_yN$, which we can consider to be a subspace of $T_{y}M$, slightly abusing notation to identify $y$ and $r_N(y)$ via the local immersion.
Furthermore, in a neighborhood of $x$ the co-orientation of $r_W$ determines an orientation of the normal bundle of the local immersion of $W$, and we can take the fiber of the normal bundle at $r_W(x)$ to be $T_yN$.

\begin{lemma}\label{L: intersection number}
	The intersection number $I_M(W,N)$ is equal to signed count of intersection points of $W$ and $N$, counting an intersection point with $+1$ if the normal co-orientation of $W$ agrees with the orientation of $N$ and $-1$ otherwise.
\end{lemma}

\begin{proof}
	This follows directly from \cref{C: complementary cap}.
	\begin{comment}
		We first recall the construction of the pullback orientation $W \times_M N \to N$.
		As $W$ and $N$ are immersed near their geometric intersections, we can restrict to these immersed regions of $W$ and $N$ and so take the dimension of the Euclidean factor to be $0$ in Definition \ref{D: pullback coorient}.
		So then $\nu W$ is the oriented normal bundle of $W$ determined by the co-orientation in the immersed region, and we pull this back to be a normal bundle of $W \times_M N$ in $N$.
		In this simplified situation, Definition \ref{D: pullback coorient} tells us that the co-orientation of the pullback is the normal co-orientation corresponding to this pullback bundle, which is just the restriction of the normal bundle to the intersection point.
		So the co-orientation at each intersection point can be written as $(1,1 \wedge \beta_{\nu W}) = (1, \beta_{\nu W})$.
		So now by the discussion following Definition \ref{D: co-orientations}, we orient each point of the pullback by $1$ if $\beta_{\nu W}$ agrees with the orientation of $N$ and $-1$ otherwise.
		The lemma follows.
	\end{comment}
\end{proof}

\begin{lemma}\label{L: Q-trivial intersection}
	Suppose $W \in PC_\Gamma^i(M)$ and $N \in PC_{i}^\Gamma(M)$ are transverse and that $W \in Q^i(M)$.
	Then $I(W,N) = 0$.
\end{lemma}

\begin{proof}
	By \cref{L: pullback with Q}, we know $W \times_M N \in Q_0(M)$, so $I(W,N) = \aug(W \times_M N) = 0$ by definition and \cref{L: Q0}.
\end{proof}

\begin{definition}\label{D: intersection homomorphism}
	Given the manifold without boundary $M$ cubulated by $X$, we define the \textbf{intersection map} $\mc I \colon C^*_{\Gamma \pf X}(M) \to K^*(X)$ by the possibly infinite formal sum $$\mc I(\uW) = \sum_F I_M(W,F)F^*,$$ where the sum is taken over faces $F$ of the cubulation $X$ such that $\dim(F)+\dim(W) = \dim(M)$ and the $W$ on the right hand side is any element of $PC^*_{\Gamma \pf X}(M)$ representing $\uW$.

	In particular, for a face $F$ of dimension $\dim(M)-\dim(W)$, we have $$\mc I(\uW)(F) = I_M(W,F) = \aug(W \times_M F).$$
\end{definition}

\begin{proposition}\label{P: I is well defined}
	The intersection map $\mc I$ is a well-defined chain map.
\end{proposition}

\begin{proof}
	If $W, W' \in PC^*_{\Gamma \pf X}(M)$ are two representatives of $\uW$ then $W \sqcup -W' \in Q^*(M)$ and it is transverse to $X$.
	So for any face $F$ we have $\aug(W \times_M F)-\aug(W' \times_M F) = \aug((W \sqcup -W') \times_M F) = 0$ by \cref{L: Q-trivial intersection}.
	So $\mc I(\uW)$ does not depend on the choice of $W$.

	To see that $\mc I$ is a chain map, let $W$ be transverse to the cubulation and representing $\uW$.
	Then we compute for any face $f$ of $X$ that
	\begin{align*}
		\mc I(\bd\uW)(f)& = \aug((\bd W) \times_M f)\\
		& = \aug(W \times_M \bd f)\\
		& = \mc I(\uW)(\bd f).
	\end{align*}
	For the second equality, we use \cref{P: Leibniz cap} together with the facts that the augmentations are both trivial unless $\dim(W \times_M f) = 1$ and that $\aug(\bd (W \times_M f)) = 0$.
\end{proof}

\begin{example}\label{E: coho 0 generator}
	Let $M$ be any connected manifold without boundary and given a cubulation $X$, let $\uW \in C^*_{\Gamma \pf X}(M)$ be represented by the tautologically co-oriented identity map $M \to M$, and let $v$ be a (positively-oriented) $0$-dimensional vertex of $X$.
	By \cref{P: cap with 1}, we have $M \times_M v = v$, and so
	\[\mc I(\uW)(v) = \aug(M \times_M v) = \aug(v) = 1.\]
	In other words, $\mc I(\uW)$ takes the value $1$ on each vertex of $X$, so it is the standard generator of $H^0(X) \cong \Z$.
	It will therefore follow from \cref{T: intersection qi}, below, that the tautologically co-oriented identity map $M \to M$ generates $H^0_\Gamma(M) \cong \Z$, as promised in \cref{E: first examples}.
\end{example}

\begin{example}\label{E: uncountable}
	Let $Z$ denote the integers, considered as a space with the discrete topology.
	This space has a unique cubulation, which we will also write simply as $Z$.
	In this example, we demonstrate that the map $\mc I \colon C^0_\Gamma(Z) \to K^0(Z)$ is an isomorphism.
	As $K^0(Z) = \Hom(K_0(Z),\Z) \cong \Hom\left(\displaystyle\oplus_{i \in \Z} \Z, \Z\right) \cong \prod_{i\in \Z} \Z$, this shows that the geometric cochain groups $C^*_\Gamma(M)$ need not be free abelian \cite{Sch08}.

	To demonstrate the isomorphism, first consider an element $\alpha \in K^0(Z)$.
	The cochain $\alpha$ is determined by the value it assigns to each element of $Z$.
	For $x \in Z$, let $V(x)$ denote the discrete space with $|\alpha(x)|$ points, which we think of as mapping to $x \in Z$ with the co-orientation chosen according to whether $\alpha(x)$ is positive or negative (if it is zero we let $V(x)$ be empty).
	Then $V = \displaystyle\sqcup_{i \in \Z} V(x)$ is a countable collection of points with a proper co-oriented map to $Z$, and $\mc I(\uV) = \alpha$.
	So $\mc I$ is surjective.

	Next, suppose that $\uV \in C^0_\Gamma(Z)$, represented by $V \in PC^0_\Gamma(Z)$, and suppose $\mc I(Z) = 0$.
	As $V \to Z$ is proper, the preimage of each point $x \in Z$ is a finite set of points, and as $\mc I(\uV) = 0$, the restriction to the preimage $r_V^{-1}(x)$ must have the same number of points mapping to $x$ with each co-orientation.
	By matching the points in each $r_V^{-1}(x)$ into pairs mapping with opposite co-orientations, we obtain a co-orientation reversing automorphism of $V$ by swapping the elements of each pair.
	So $V$ is trivial and $\uV = 0$.
	This $\mc I$ is also injective.
\end{example}

Our goal now is to show that the intersection map $\mc I$ induces an isomorphism $H^i_{\Gamma \pf X}(M) \to H^i(X)$ whenever $H^i_\Gamma(M)$ and $H^i(X)$ are finitely generated.
Recall that we already know these groups are abstractly isomorphic by \cref{T: transverse complex,T: geometric is singular} and the footnote on page \pageref{FN: cubical and singular}.
Here is the formal statement of the theorem:

\begin{theorem}\label{T: intersection qi}
	If $M$ is a manifold without boundary cubulated by $X$, the intersection map $\mc I \colon H^i_{\Gamma \pf X}(M) \to H^i(X)$ is a surjection.
	If, in addition, $H^i(M)$ is finitely generated, then $\mc I$ is an isomorphism.
\end{theorem}

The proof will take us the remainder of \cref{S: transversality}.
We begin in the next subsection by using the cubical structure to start building an inverse map to $\mc I$.

We conjecture that $\mc I$ is always an isomorphism, but we have not been able to demonstrate this.


\begin{remark}\label{R: intersection map extension}
	Putting together the map $\mc I \colon H^*_{\Gamma \pf X}(M) \to H^*(X)$ with the inverse of the isomorphism $H^*_{\Gamma \pf X}(M) \to H^*_\Gamma(M)$ of \cref{T: transverse complex}, it is sometimes useful to abuse notation and speak of the ``intersection map'' $\mc I \colon H^*_\Gamma(M) \to H^*(X)$.
	This map is given by taking a cohomology class representative that is transverse to the cubulation and applying the intersection map $\mc I$ to find a cubical cocycle representing the target cohomology class.
\end{remark}

Before starting toward the proof, we provide an application to cohomology with coefficients.

\begin{corollary}
	If $H_*(M)$ is finitely-generated in each degree and $G$ is an abelian group, then $H^*(C^*_\Gamma(M) \otimes G) \cong H^i(M;G)$.
\end{corollary}
\begin{proof}
	First choose a cubulation $X$ of $M$.
	Next, as each $H_*(M)$ is finitely generated, by \cite[Lemma 56.3 and Theorem 45.1]{Mun84} we can choose a chain complex $F_*$ and a map $\phi \colon F_* \to K_*(X)$ such $F_*$ vanishes in negative degrees, is finitely-generated in each degree, and $\phi$ is a quasi-isomorphism.

	Now consider the maps
	$$C^*_\Gamma(M) \otimes G \hookleftarrow C^*_{\Gamma \pf X}(M) \otimes G \xr{\mc I \otimes \id} K^*(X) \otimes G = \Hom(K_*(X),\Z)\otimes G \xr{\phi^* \otimes \id} \Hom(F_*, \Z) \otimes G.$$
	Omitting the tensor products with $G$, these maps are all quasi-isomorphisms by \cref{T: transverse complex}, \cref{T: intersection qi}, and \cite[Theorem 45.5]{Mun84}.
	Furthermore, continuing to omit $\otimes G$, these complexes are all torsion free and so flat, and any submodule is thus also flat.
	So it follows from the Universal Coefficient Theorem for Homology \cite[Theorem 7.55 ]{ROTMAN} and the Five Lemma that this remains a chain of quasi-isomorphisms after tensoring with $G$.
	Now by Step 2 of the proof of \cite[Theorem 56.1]{Mun84}, $\Hom(F_*, \Z) \otimes G \cong \Hom(F_*, G)$, and this is quasi-isomorphic to $\Hom(K_*(X), G) = K^*(X; G)$, again by \cite[Theorem 45.5]{Mun84}.
\end{proof}

In this argument, the requirement that $H_*(M)$ be finitely generated is used not just to ensure $\mc I$ is a quasi-isomorphism.
It is needed to construct an $F_*$ and have $\Hom(F_*, \Z) \otimes G \cong \Hom(F_*, G)$.

\subsubsection{Dualization in cubes}\label{S: dual cubes}

Analogous to barycentric subdivisions of simplices, we will need to consider standard subdivisions of cubes.
For this we let $\jinterval$ denote the interval $\interval = [0,1]$ thought of as the (non-disjoint) union $[0,1/2] \cup [1/2,1]$.
We can then write $\jinterval^n = \left([0,1/2] \cup [1/2,1]\right)^n$, with the idea being that we consider $\interval^n$ as the union of $2^n$ \textit{subcubes} of side length $1/2$, each of which is the product within $\interval^n$ of $n$ factors, each factor equal to either $[0,1/2]$ or $[1/2,1]$.
We refer to $\jinterval^n$ with this structure as the \textbf{central subdivision} of $\interval^n$.
It is a cubical complex with the evident partial orders obtained from $0 < 1/2 < 1$.
The resulting subdivision of each cubical face of $\interval^n$ is precisely the central subdivision obtained by treating that face as some $\interval^k$ in its own right.

Analogously to the case with $\interval^n$, each cube $S$ of $\jinterval^n$ possesses faces (some of which it shares with other $n$-cubes) consisting of subsets of $S$ in which some variables have been bound to the values $0$, $1$, or $1/2$.
In general we refer to such faces as \textbf{faces of $\jinterval^n$}.
If no variable of such a face is bound to $0$ or $1$, we say that we have an \textbf{internal face of $\jinterval^n$}, otherwise we call it an \textbf{external} face.
External faces are all subsets of $\bd \interval^n$; internal faces are not subsets of $\bd \interval^n$.

To each face $F$ of $\interval^n$, we refer to the point $\hat F$ at which all its free variables are equal to $1/2$ as the \textbf{center} of $F$.
Each vertex is its own center.
To each face $F$ of $\interval^n$ we define its \textbf{dual face in $\interval^n$}, or simply its \textbf{dual}, to be the face $F^\vee$ of $\jinterval^n$ determined as follows:
\begin{itemize}
	\item If $i \in F_{01}$ (i.e.\ the coordinate $x_i$ is free in $F$), then $x_i = 1/2$ in $F^\vee$.

	\item If $i \in F_0$ (i.e.\ the coordinate $x_i$ is bound to $0$ in $F$), then $x_i$ is free in $[0,1/2]$ in $F^\vee$.

	\item If $i \in F_1$ (i.e.\ the coordinate $x_i$ is bound to $1$ in $F$), then $x_i$ is free in $[1/2,1]$ in $F^\vee$.
\end{itemize}

It is clear that $F$ and $F^\vee$ have complementary dimensions and that they intersect naively transversely in the center of $F$.

\begin{lemma}
	The set function $F \to F^\vee$ is a bijection between the faces of $\interval^n$ and the internal faces of $\jinterval^n$.
\end{lemma}

\begin{proof}
	Injectivity is clear as two different faces of $\interval^n$ will have different partitions of $\bar n$.

	Next consider an internal face of $\jinterval^n$.
	By definition this is a set in which some set of variables $A$ has been bound to $1/2$ while two other sets of variables, $B$ and $C$, are free on $[0,1/2]$ or $[1/2,1]$, respectively.
	But this is $F^\vee$ for the face $F$ with partition $(B,A,C)$.
	So our function is surjective.
\end{proof}

As each face $F$ of $\interval^n$ carries a natural orientation $\beta_F$ determined by the order of its free variables (or the orientation $1$ for vertices), this provides $F^\vee$ with the corresponding normal co-orientation.
In other words, $F^\vee$ is co-oriented at all points by the co-orientation $(\beta_{F^\vee}, \beta_{F^\vee} \wedge \beta_F)$, where $\beta_{F^\vee}$ is an arbitrary orientation of $F^\vee$.
Assigning $F^\vee$ this co-orientation, we interpret its embedding in $\interval^n$ as representing a cochain in $\interval^n$ of index $\dim(F)$.
We define a map $\Psi \colon K^*(\interval^n) \to C_\Gamma^*(\interval^n)$ given on generators by $\Psi(F^*) = F^\vee$, recalling that geometric chains and cochains can be defined on manifolds with corners --- see \cref{D: PC,D: chains and cochains}.
To avoid overburdening the notation too much, throughout the remainder of this section we will simply write $F^\vee$ for the output geometric cochain, rather than $\underline{F^\vee}$; it should be clear from context when we refer to the cube face and when we refer to its corresponding geometric cochain.

We introduce one more piece of notation for the following lemma.
If $f$ is a face in $\jinterval^n$, we let $\bd_{\text{int}}f$ denote the union of the internal $\dim(f)-1$ faces of $\bd f$ and $\bd_{\text{ext}}f$ denote the union of the $\dim(f)-1$ external faces of $f$.
If $f$ is co-oriented, then we interpret the terms of $\bd_{\text{int}}f$ and $\bd_{\text{ext}}f$ as co-oriented with the boundary co-orientations.
When $f$ is interpreted as a geometric cochain, we interpret $\bd_{\text{int}}f$ and $\bd_{\text{ext}}f$ as sums of geometric cochains, in which case $\bd f = \bd_{\text{int}}f + \bd_{\text{ext}}f$.
We can then extend $\bd_{\text{int}}$ and $\bd_{\text{ext}}$ to linear operators in the obvious way.

\begin{lemma}\label{L: dualizing bijection}
	For any face $F$ of $\interval^n$, we have $\Psi(d F^*) = \bd_{\text{int}}\Psi(F^*).$
\end{lemma}

\begin{proof}
	We first show that there is a bijection between the internal faces of $\Psi(F^*)$ and the set of $E^\vee$ such that $E^*$ has non-zero coefficients in $dF^*$.
	Then we will return to carefully consider the co-orientations.

	So let $F$ be a face of $\interval^n$.
	Recall that $F$ is determined by the partition $(F_0,F_{01}, F_1)$ of $\overline{n}$ corresponding respectively to variables set to $0$, free variables of $F$, and variables set to $1$.
	By definition, $(dF^*)(E) = F^*(\bd E)$ and so the only faces participating in $dF^*$ are those $\dim(F)+1$ faces that have $F$ as a boundary, in other words those faces whose free variables are those in $F_{01}$ plus one more variable from $F_0$ or $F_1$.

	Now let us consider again $F^\vee$, which we recall is obtained by setting all variables in $F_{01}$ to $1/2$ and letting the variables in $F_0$ and $F_1$ become free variables on $[0,1/2]$ and $[1/2,1]$, respectively.
	Each boundary face of $F^\vee$ is then obtained by either setting one of the variables in $F_0$ to $0$ or $1/2$ or one of the variables in $F_1$ to $1/2$ or $1$.
	Furthermore, the internal faces are those where the variable in $F_0$ or $F_1$ has been set to $1/2$.
	So, in summary, an internal face of $F^\vee$ has all of the variables in $F_{01}$ as well as exactly one other variable set to $1/2$ and the rest remain free over the appropriate domains, namely $[0,1/2]$ for those in $F_0$ and $[1/2,1]$ for those in $F_1$.
	But, from the definition of dualization $E \to E^\vee$, this exactly describes the duals $E^\vee$ of the faces participating in $dF^*$, which is sufficient for our desired bijection due to the bijection of \cref{L: dualizing bijection}.

	It remains now to consider the signs.
	We recall that the boundary formula for cubes has the form
	$$\bd E = \sum_{i = 1}^k (-1)^i(E \delta_i^0-E \delta^1_i),$$ where the $\delta$s denote the embeddings of the faces.
	In $K_*(\interval^n)$, we can shorten this notation to $$\bd E = \sum_{i = 1}^k (-1)^i(E_i^0-E^1_i),$$ letting $E_i^j$, $j \in \{0,1\}$, denote the $i$th ``front or back face'' according to $j = 1$ or $j = 0$.
	In particular, we note that there are two factors, both $i$ and $j$, affecting sign.

	So now let us again fix a face $F$ of $\interval^n$ and let $E$ be a face of dimension $\dim(F)+1$ that includes $F$ in its boundary as $F = E_i^j$.
	Representing $E$ as $E = (E_0,E_{01},E_1)$, we obtain $F$ by setting the $i$th variable, which is in $E_{01}$, to $j$.
	From the coboundary formula, we have
	\begin{equation*}
		(dF^*)(E) = F^*(\bd E) = (E_i^j)^*\left(\sum_{i = 1}^k (-1)^i(E_i^0-E^1_i)\right)
		= (E_i^j)^*((-1)^{i+j}E_i^j) = (-1)^{i+j}.
	\end{equation*}
	So 	$E^*$ occurs in $dF^*$ with coefficient $(-1)^{i+j}$.
	Thus we must show that $\Psi(E^*) = E^\vee$ disagrees by a sign of $(-1)^{i+j}$ from the co-orientation assigned to $E^\vee$ as a member of $\bd_{\text{int}} \Psi(F^*) = \bd_{\text{int}} (F^\vee)$.

	We continue to assume $F = E_i^j$ and now consider $F^\vee$.
	If $A=(a,b,\ldots)$ is an ordered subset of $\overline{n}$, we let $\beta_A = e_a \wedge e_b \wedge \cdots$, where $e_a$ is, as usual, the standard unit vector in the $a$th coordinate.
	If $A, B$ are disjoint ordered subsets sets, we write $A \cup B$ for their concatenation.
	With this notation, we can write the normal co-orientation of $F^\vee$ as $(\beta_{F_0 \cup F_1},\beta_{F_0 \cup F_1} \wedge \beta_{F_{01}})$.
	Let $k \in F_0 \cup F_1$ be the unique index that is free in $E$ but bound in $F$ and so also free in $F^\vee$.
	Then $E^\vee$ is the boundary component of $F^\vee$ with $x_k$ set to $1/2$.
	In this case the boundary co-orientation of $E^\vee$ in $F^\vee$ is $(\beta_{F_0 \cup F_1 - \{k\}},\beta_{F_0 \cup F_1 - \{k\}} \wedge (-1)^{j+1} e_k)$.
	The sign $(-1)^{j+1}$ is because if $j = 1$ then in $F^\vee$ the variable $x_k$ is free on $[1/2,1]$ so the inward normal vector at $1/2$ points in the direction of $e_k$, and if $j = 0$ then in $F^\vee$ the variable $x_k$ is free on $[0,1/2]$ so the inward normal vector at $1/2$ points in the direction of $-e_k$.
	So the boundary co-orientation for $E^\vee$ in $\interval^n$ as a piece of $\bd F^\vee$ is the composition $$(\beta_{F_0 \cup F_1 - \{k\}},\beta_{F_0 \cup F_1 - \{k\}} \wedge (-1)^{j+1} \beta_{e_k})*(\beta_{F_0 \cup F_1},\beta_{F_0 \cup F_1} \wedge \beta_{F_{01}}).$$

	Meanwhile, the natural co-orientation for $E^\vee$ is $(\beta_{E_0 \cup E_1},\beta_{E_0 \cup E_1} \wedge \beta_{E_{01}}).$
	But $E_0 \cup E_1 = F_0 \cup F_1 - \{k\}$, so
	\begin{align*}
		(\beta_{F_0 \cup F_1 - \{k\}},\beta_{F_0 \cup F_1 - \{k\}}& \wedge (-1)^{j+1} \beta_{e_k})*(\beta_{F_0 \cup F_1},\beta_{F_0 \cup F_1} \wedge \beta_{F_{01}})\\
		& = (-1)^{j+1}(\beta_{E_0 \cup E_1},\beta_{E_0 \cup E_1} \wedge \beta_{e_k})*(\beta_{E_0 \cup E_1} \wedge \beta_{e_k},\beta_{E_0 \cup E_1} \wedge \beta_{e_k} \wedge \beta_{F_{01}})\\
		& = (-1)^{j+1}(\beta_{E_0 \cup E_1},\beta_{E_0 \cup E_1} \wedge \beta_{e_k} \wedge \beta_{F_{01}})\\
		& = (-1)^{j+i}(\beta_{E_0 \cup E_1},\beta_{E_0 \cup E_1} \wedge \beta_{E_{01}}).
	\end{align*}
	In the second line, we use that expressions of the form $(\beta_A, \beta_A \wedge \beta_B)$ are independent of the choice of $\beta_A$, so we replace $\beta_{F_0 \cup F_1}$ with $\beta_{E_0 \cup E_1} \wedge \beta_{e_k}$.
	But as $F = E_i^j$, we know that $k$ is the $i$th variable of $E_{01}$, so
	$\beta_{e_k} \wedge \beta_{F_{01}} = (-1)^{i-1}\beta_{E_{01}}$, which we use in the last equality.
	Thus the two co-orientations disagree by $(-1)^{i+j}$ as required.
\end{proof}


We need some additional notation for the next lemma.
Suppose $F$ is a face of $E$, which we will write $F \subseteq E$, recalling that we identify faces of a cubical complex with their vertex sets.
Let $F_E^\vee$ denote the dual of $F$ in $E$.
In other words, we identify $E$ with $\interval^k$ for an appropriate $k$ and form the dual of the face corresponding to $F$ in $E$.

\begin{lemma}\label{L: ext faces}
	Let $F$ be a face of $\interval^n$.
	Then the external faces $\bd_{\text{ext}}F^\vee$ of $F^\vee$ correspond exactly to the $F_E^\vee$ as $E$ ranges over the $n-1$ faces of $\interval^n$ containing $F$.
	Furthermore, if $F^\vee$ is given the normal co-orientation induced by $F$ as above, then the co-orientation of $F^\vee_E \to F^\vee \to \interval^n$ considered as a piece of the boundary of $F^\vee$ is given by $(\beta_{F_E^\vee},\beta_{F_E^\vee} \wedge \beta_v \wedge \beta_F)$, where $\beta_{F_E^\vee}$ is any arbitrary orientation for $F_E^\vee$, $v$ is an inward pointing normal to $\interval^n$ at $E$, and $\beta_F$ is the orientation of $F$ as a face of $\interval^n$.
\end{lemma}

\begin{proof}
	We first observe that each $n-1$ cube $E$ is determined by its single bound variable, and any cube $F$ in $E$ must share that bound variable.
	Conversely, given $F$, to obtain an $n-1$ cube containing it, we free all but one of its bound variables.
	So the $n-1$ cube $E$ contains $F$ if and only if there is an $i \in F_0$ such that $i \in E_0$ or an $i \in F_1$ such that $i \in E_1$.

	Now from the definitions, we recall that $F^\vee$ is obtained by setting the free variables of $F$ to $1/2$ and the bound variables of $F$ to be free, with the variables of $F_0$ running over $[0,1/2]$ and the variables of $F_1$ running over $[1/2,1]$.
	So if $f$ is an external face of $F^\vee$, it is obtained from the conditions defining $F^\vee$ by setting $x_i=0$ for an $i \in F_0$ or $x_i$ to $1$ for an $i \in F_1$.
	Thus $x_i$ is the only variable of $f$ bound to $0$ or $1$, and so the corresponding $E$ determined by $x_i = 0$ or $x_i = 1$ is the unique $n-1$ cube of $\interval^n$ containing $f$, and it also contains $F$ (since $i$ is in both $F_0$ and $E_0$ or both $F_1$ and $E_1$).
	Conversely, if $F \subseteq E$ and $i \in F_0$ with $x_i = 0$ defining $E$, then there is a unique external face of $F^\vee$ for which $x_i = 0$, namely the one with $x_i=0$, $x_k = 1/2$ for all $k \in F_{01}$, and all other variables free.
	Similarly, if $F \subseteq E$ and $i \in F_1$ with $x_i = 1$ defining $E$.
	So we have a bijection between external faces of $\bd F^\vee$ and the $n-1$ faces $E$ containing $F$.
	Furthermore, after we have set $x_i$ to $0$ or $1$ as appropriate, the behavior in the remaining variables shows that the external face of $\bd F^\vee$ contained in $E$ is precisely $F^\vee_E$.

	It remains to consider the co-orientations.
	Suppose $f$ is an external face of $F^\vee$ in the $n-1$ face $E$, i.e.\ $f = F^\vee_E$.
	The co-orientation of $F^\vee$ in $\interval^n$ and the co-orientation of $f$ in $E$ are both the normal co-orientations determined by the orientation of $F$.
	As $f$ is part of $\bd F^\vee$, its boundary co-orientation in $\interval^n$ is therefore the composite $$(\beta_f,\beta_f \wedge \beta_v)*(\beta_f \wedge \beta_v,\beta_f \wedge \beta_v \wedge \beta_F) = (\beta_f,\beta_f \wedge \beta_v \wedge \beta_F),$$ where $\beta_f$ is any arbitrary orientation for $f$, $v$ is the inward pointing normal of $f$ in $F^\vee$, which in this case is also an inward pointing normal of $E$ in $\interval^n$, and we use $\beta_f \wedge \beta_v$ as a convenient orientation for $F^\vee$.
\end{proof}

\subsubsection{Dualization in cubical complexes}\label{S: dualization of complexes}

Now suppose that $X$ is any cubical complex.
We obtain the \textbf{centrally subdivided cubical complex $sd(X)$} by replacing each cube $\interval^n$ with $\jinterval^n$.
This is well defined as we have noted that the central subdivision of each cube is consistent with the central subdivision of each cube of which it is a face.

Now suppose that $M$ is an $n$-manifold without boundary cubulated by the cubical complex $X$ via $\phi \colon |X| \to M$.
For a given face $F$ of an $n$-cube $B$ of $X$, we can extend the above definitions, and abuse notation, by letting $F$ refer also to the image of $F$ in $M$ and letting $F_B^\vee$ also denote the composition $F_B^\vee \into \interval^n \into |X| \xr{\phi} M$, where $F_B^\vee$ is the dual of $F$ in $B$ as above.
Similarly, we consider this version of $F_B^\vee$ in $M$ to be co-oriented by the normal co-orientation obtained from the orientation of $F$, and we can then further abuse notation and consider $F_B^\vee$ to also represent a geometric cochain.
Moreover, in the cubulated $M$ we extend our earlier definition and write $F^\vee = \sqcup_{F \subseteq B} F^\vee_B$, where the union is taken over all $n$-cubes $B$ having $F$ as a face; when considering these as geometric cochains, we can replace union with sum.
We similarly define $\Psi_B(F^*) = F_B^\vee$, which is consistent with the dualization within a single cube defined above, and then set $\Psi(F^*) = \sum_{F \subseteq B} \Psi_B(F^*) = \sum_{F \subseteq B} F_{B}^\vee = F^\vee$.
This is sufficient to determine a homomorphism $\Psi \colon K^*(X) \to C_\Gamma^*(M)$, thinking of elements of $K^*(X)$ as possibly infinite formal sums $\sum n_i F^*$ with the sum taken over all faces of a given dimension; compare \cite[Section 42]{Mun84}. The image of such an element of $K^*(X)$ under $\Psi$ corresponds to a map from a manifold with corners to $M$ whose domain is a countable collection of cubes, and this map is proper as every point of $M$ has a neighborhood that intersects only finitely many image cubes.

\begin{lemma}\label{L: dual chain map}
	$\Psi$ gives a chain map $K^*(X) \to C_\Gamma^*(M)$.
\end{lemma}

\begin{proof}
	It suffices to show that for any face $F$ of the cubulation $X$ of $M$ we have $\Psi(d F^*) = \bd\Psi(F^*)$.

	By \cref{L: dualizing bijection} and the definition of the extended $\Psi$, we know that
	$$\Psi(dF^*) = \sum_{F \subseteq B} \Psi_B(dF^*) = \sum_{F \subseteq B}\bd_{\text{int}} \Psi_B(F^*) = \sum_{F \subseteq B} \bd_{\text{int}}F^\vee_B,$$
	where $\bd_{\text{int}}$ refers to the internal boundary in the appropriate $B$, so we must show that $\sum_{F \subseteq B} \bd_{\text{int}}(F^\vee_B) = \sum_{F \subseteq B} \bd (F^\vee_B)$, in other words that all of the external faces of the terms of $\bd\Psi(F^*) = \sum_{F \subseteq B} \bd (F^\vee_B)$ cancel in the sum.

	For this, let us fix an $n$-cube $B$ containing $F$, and let $E$ be an $n-1$ face of $B$ containing $F$.
	As $M$ is an $n$-manifold, there is exactly one other $n$-cube, say $B_1$, in the cubulation that shares the face $E$ with $B$.
	Furthermore, by \cref{L: ext faces}, $E$ contains external faces of $\bd(F^\vee_B)$ and $\bd(F^\vee_{B_1})$ and they both correspond geometrically to $F^\vee_E$.
	Also by the lemma, the co-orientation as a boundary piece of $F^\vee_B$ is $(\beta_{F_E^\vee},\beta_{F_E^\vee} \wedge \beta_{v_B} \wedge \beta_F)$, where $v_B$ is an inward pointing vector of $B$ at $E$, and the co-orientation as a boundary piece of $F^\vee_{B_1}$ is $(\beta_{F_E^\vee},\beta_{F_E^\vee} \wedge \beta_{v_{B_1}} \wedge \beta_F)$, where $v_{B_1}$ is an inward pointing vector of $B_1$ at $E$.
	Since a normal vector to $E$ that is inward pointing with respect to $B_1$ is outward pointing with respect to $B$, and vice versa, these are opposite co-orientations, so, as precochains, these two boundary pieces constitute a trivial pair and so cancel in $C^*_\Gamma(M)$.

	Applying this argument to all $n-1$ cubes that contain $F$ completes the argument by \cref{L: ext faces}.
\end{proof}

Morally speaking, $\Psi$ will be our inverse to the intersection map $\mc I$, but unfortunately the elements of $PC^*_\Gamma(M)$ that represent the image of $\Psi$ are not transverse to the cubulation.
So we need another step.

\subsubsection{Pushing the dual cubulation}

To remedy the problem with the image of $\Psi$ consisting of elements of $PC^*_\Gamma(M)$ that are not transverse to the cubulation, we construct a homotopy of $M$ to itself that pushes these cochains into transverse position with respect to the cubulation, which we regard as fixed.
Moreover, we want to do so in a way such that the intersection number of the pushed $F^\vee$ with $F$ will be $1$, as expected.
Constructing such a homotopy is the purpose of the following technical lemma.
As we will see in the proof, the actual construction is a bit fiddly in order to ensure all the needed properties.

\begin{lemma}\label{L: push dual}
	Suppose $M$ is a manifold without boundary with a cubulation $X$.
	Then there is a proper smooth homotopy from the identity to a map $h \colon M \to M$ such that for each face $F$ of $X$ the following hold:
	\begin{enumerate}
		\item $h|_{F^\vee} \colon F^\vee \to M$ is transverse to $X$
		\item the only $\dim(F)$-face of $X$ that intersects $h(F^\vee)$ is $F$
		\item $I_M(h(F^\vee),F) = 1$.
	\end{enumerate}
\end{lemma}

\begin{proof}
	We will construct our homotopy in multiple steps.
	The basic idea is first to construct small isotopies near the centers $\hat F$ of the faces $F$ of $X$ that push the corresponding $F^\vee$ into transverse position with $F$ and so that the intersection number of the shifted $F^\vee$ with $F$ is $1$, giving the third condition.
	These will also be designed to ensure enough transversality in neighborhoods of the $\hat F$.
	Then we perform a more global shift to push the rest of $sd(X)$ into transverse position with $X$ to achieve the first condition, while leaving fixed the isotopies already constructed near the $\hat F$.
	We also ensure the global shift is small enough to provide the second condition while also not disrupting the third.

	Throughout we may assume that $M$ is embedded properly in some $\R^N$ with an $\epsilon$-neighborhood $M^\epsilon$ (with $\epsilon$ a function of $x \in M$) and a submersion $\pi \colon M^\epsilon \to M$; see \cite[Section 2.3]{GuPo74}.
	We may further assume that $\epsilon(x) < 1$ for all $x \in M$.
	As a subspace of $\R^N$, we can consider $M$ as a metric space with the subspace metric.

	To create a template and explain the basic idea, we first consider the standard $m = \dim(M)$-cube $\interval^m = [0,1]^m \subset \R^m$.
	Let $e_i$ denote the unit tangent vector of $\R^m$ pointing in the positive $i$th direction.
	Let $f = (f_0,f_{01},f_1)$ be a face of $\interval^m$, let $\hat f$ be its center, and define the vector $v_f$ to be the unit vector in the direction $\sum_{i \in f_1} e_i-\sum_{i \in f_0} e_i$ (if $f_0 = f_1 = \emptyset$, let $v = 0$; we leave the reader to adjust for this case in what follows, noting that in this case $f^\vee = \hat f$ is already transverse to $f = \interval^m$).
	At points of $f$, the vector $v_f$ points outward from the cube $\interval^m$.
	The vector $v_f$ is also tangent to $f^\vee$ at any point of $f^\vee$, and for small $\delta>0$ the points $\hat f-\delta v_f$ lie in the interior of the face $f^\vee$.
	So, if we were to translate $f^\vee$ by $\delta v_f$ for a sufficiently small positive $\delta$, we would obtain a translate of $f^\vee$ within the $m-\dim(f)$ plane containing it.
	As this plane is orthogonal to $f$ and intersects it at the single point $\hat f$, the only intersection of $f$ with the translated $f^\vee+\delta v_f$ is at $\hat f$ with a point in the image of the interior of $f^\vee$.
	As the translation preserves the tangent plane of $f^\vee$, this is a transverse intersection, and the translation preserves the normal co-orientation so that the intersection number of $f^\vee+\delta v_f$ with $f$ is $1$.
	Furthermore, under a sufficiently small perturbation of $\delta v_f$ to a nearby $z_f$ it remains the case that the translate $f^\vee + z_f$ intersects $f$ transversely in a single point, and the only intersection of $f$ with $f^\vee + z_f$ is with the translate of a point in the interior of $f^\vee$ (though this intersection need not be at $\hat f$) and the intersection number is 1.
	Additionally, by the Transversality Theorem of \cite{GuPo74}, for almost all vectors $u$ in $\R^m$, translation by $u$ takes all open faces of $\jinterval^m$ into transverse position with respect to all open faces of $\interval^m$.
	So almost all vectors $z_f$ sufficiently close to $\delta v_f$ have the property that translation by $z_f$ both makes all open faces of $\jinterval^m$ transverse to all open faces of $F$ and satisfies that the intersection number of $f^\vee$ and $f$ is $1$.

	Next, suppose we are given a small closed ball $D^f_r$ centered at $\hat f$ in $\R^m$ with $r$ sufficiently small that $D^f_r$ does not intersect any faces of $\interval^m$ that do not contain $f$ (and in particular $D^f_r$ does not intersect any other faces of the same dimension as $f$ besides $f$ itself).
	We choose numbers $0<r_4 < r_3 < r_2<r_1<r$ and let $D^f_{r_j}$ be closed balls of radius $r_j$ centered at $\hat f$.
	In the first part of the argument we will be concerned primarily with $r$, $r_1$, and $r_2$, but we will need $r_3$ and $r_4$ later.
	We choose a smooth function $\eta \colon \R^m \to [0,1]$ such that $\eta(x) = 1$ on $D^f_{r_2}$ and $\eta(x) = 0$ outside of $D^f_{r_1}$.
	Let $\delta, \delta_1 > 0$ satisfy $0 < \delta \ll \min\left\{\frac{r_4}{2}, \frac{r-r_1}{2}\right\}$, $0 < \delta_1 < \delta$, and $\delta_1$ is smaller than any of the non-zero coordinates of $\delta v_f$.
	We will impose an additional condition on $\delta_1$ below.
	Next, let $z_f$ be a vector in $\R^m$ such that $|z_f-\delta v_f|\ll \delta_1$; by the condition on $\delta_1$, the signs of the coordinates of $z_f$ in $f_0$ and $f_1$ agree with those of $\delta v_f$, so $z_f$ continues to point outward from $\interval^m$ at all points of $f$.
	Finally, let $\Phi \colon \R^m \to \R^m$ be defined by $\Phi(x) = x+ \eta(x) z_f$.

	The map $\Phi$ has the following properties:
	\begin{enumerate}
		\item Outside of $D^f_{r_1}$, the map $\Phi$ is the identity.

		\item As $|z_f|\leq |v_f| + |z_f-\delta v_f| < \delta+\delta_1 < 2 \delta < r-r_1$ and no point moves further than $|z_f|$ under $\Phi$, we have $\Phi(D^f_{r_1})\subset D^f_r$.

		\item On $D_{r_2}^f$, the map $\Phi$ is translation by $z_f$ as in the preceding paragraph.
		As $\delta < r_4 < r_2$, if we translate $f^\vee \cap D_{r_2}^f$ by $\delta v_f$, then there is exactly one intersection point between $(f^\vee \cap D_{r_2}^f) + \delta v_f$ and $f$, and the resulting intersection number is $1$.
		As in the preceding paragraph, we choose $\delta_1$ so small that this property is maintained replacing $\delta v_f$ with $z_f$.
		Then there is exactly one intersection point between $\Phi(f^\vee \cap D_{r_2}^f)$ and $f$, and the resulting intersection number is $1$.

		\begin{comment}	\item As $|z_f| < 2\delta < r_4$, the interior of $D_{r_4}^f$ (and hence all $D_{r_j}^f$) contains both $\hat f$ and $\hat f-z_f$, the latter of which is in the interior of $\interval^m$ as $z_f$ points outward from $\interval^m$, in the $f_0$ and $f_1$ directions.
		\end{comment}

		\item\label{I: pushout} As $\Phi$ only moves points in $D_{r_1}^f$ and acts on all of $\R^m$ by translation by a non-negative scalar multiple of $z_f$ (which is a positive scalar multiple on $D_{r_2}^f$) and as $z_f$ points outward from $\interval^m$ at $f$ in the $f_0$ and $f_1$ directions, it holds for any $x \in \R^m - \interval^m$ or any $x \in f \cap D_{r_2}^f$ that $\Phi(x) \in \R^m - \interval^m$.

		\item As $|z_f| < 2\delta < r_4$, together with the above facts, the distance between the set $\Phi(f^\vee-(f^\vee \cap D_{r_4}^f))$ and the union of $\dim(f)$-faces of $\interval^m$ is positive.

		\item\label{I: Phi homotopy} $\Phi$ is homotopic to the identity via the homotopy $(x,t) \mapsto x+ t \eta(x) z_f$.
	\end{enumerate}

	We now translate this procedure to the cubulation $X$ of $M$.
	Suppose $F$ is a face of the cubulation, and choose an $m$-cube $B$ of the cubulation containing $F$ as a face.
	By assumption there is a smooth diffeomorphism $\phi$ from $\interval^m$ to $B$ that is compatible with the cubical structure.
	Let $f$ be the face of $\interval^m$ that maps to $F$.
	Then $\phi$ takes $\hat f$ to the center $\hat F$ and $f^\vee_{\interval^m}$, the dual of $f$ in $\interval^m$, to the component of $F_B^\vee$ of $F^\vee$.
	By the definition of smooth maps, there is a neighborhood $U$ of $\hat f$ in $\R^m$ on which there is defined a smooth map $\phi_U \colon U \to M$ and such that $\phi_U$ agrees with $\phi$ on $U \cap \interval^m$.
	As $\phi$ is an embedding at $\hat f$, by the Inverse Function Theorem we may choose $U$ such that $\phi_U$ is a diffeomorphism from $U$ onto its image, and by making $U$ smaller if necessary, we can assume its image in $M$ intersects only faces of $X$ that contain $F$, and in particular no other $\dim(F)$ face of $X$ besides $F$.
	We then choose a ball $D_r^f \subset U$ centered at $\hat f$.
	With this ball $D_r^f$, we can now choose quantities and define a $\Phi$ as in the preceding paragraph that is the identity outside of $D_r^f$ and that pushes $f^\vee_{\interval^m}$ into transverse position with $f$ with intersection number $1$.
	Identifying $D_r^f$ in $\R^m$ with its image in $M$ via $\phi_U$ and using that $\Phi$ is fixed outside $D_{r_1}^f$, we obtain a map of $M$ to itself that corresponds to $\Phi$ under the identification this.
	We will henceforth abuse notation and use the same symbols for subsets of $\R^m$ and the corresponding subsets of $M$; under this identification, we identify $F$ with $f$ in a neighborhood of their centers.
	By property \eqref{I: pushout} of $\Phi$ listed above, the corresponding map $\Phi$ on $M$ pushes the other components $F^\vee_C$ of $F^\vee$ for $C\neq B$ away from $B$, and so it continues to hold that $I(\Phi(F^\vee),F) = 1$ and also the distance between the set $\Phi(F^\vee-(F^\vee \cap D_{r^4}^F))$ and the union of $\dim(F)$-faces of $X$ is positive.
	To see this last fact, we can use that $\Phi$ fixes the complement of $D_{r_1}^f$, and consider the intersections $D_{r_1}^f \cap F^\vee_C$ as subsets of $\R^m$ via the identification above.
	Once again, as $|z_f| < 2 \delta < r_4$ and as $\Phi(D_{r_1}^f)\subset D_r^f$, we can find a fixed positive lower bound for the distances between $\Phi(F^\vee-(F^\vee \cap D_{r^4}^F))$ and $F$ or any other $\dim(F)$ face of $X$.
	As in the proof of the Transversality Theorem of \cite{GuPo74}, by rechoosing our $z_f$ if necessary (still with $|z_f - \delta v_f| < \delta_1$), we can maintain the above properties and also ensure that the restriction of $\Phi$ to the intersection of any face of $sd(X)$ with $int(D_{r_2}^F)$ is transverse to the cubulation\footnotemark.

	\footnotetext{Let $e$ and $c$ be respectively the intersections of faces of $sd(X)$ and $X$ with $\phi_U$; via $\phi_U$ we identify these as submanifolds of $\R^m$.
		On $D_{r_2}^F$ in $\R^m$, the map $\Phi$ acts by translation.
		But the map $\tau \colon e \times \R^m \to \R^m$ given by translation by the second coordinate is a submersion, so by the Transversality Theorem the map $\tau(-,y)$ is transverse to $c$ for almost all $y$.
		As a finite number of cubes of $X$ and $sd(X)$ intersect $U$, almost all vectors in any neighborhood of $v_f$ will thus satisfy the claim.}

	Next, we can apply this procedure at all faces $F$ of $X$ of all dimensions simultaneously by choosing a sufficiently small $D^F_r$ neighborhood of each $\hat F$ so that they are all pairwise disjoint; we let each $r$, $r_1$, $r_2$, $\delta$ and $\delta_1$ depend on $F$ though we do not include this in the notation.
	We then generalize $\Phi$ by allowing a corresponding map on all balls $D_r^F$ simultaneously, which is well defined letting $\Phi$ be the identity outside of the disjoint $D_{r_1}^F$.
	This provides a smooth map $\Phi \colon M \to M$ that satisfies the second two conditions of the theorem.
	We also observe that $\Phi$ is homotopic to the identity by extending the homotopies observed in property \eqref{I: Phi homotopy} of $\Phi$ to be the identity outside of the $D_{r_1}^F$.
	To complete the proof, we must further modify $\Phi$ to ensure transversality beyond the interiors of the $D_{r_2}^F$ and without destroying the other required properties.

	Let $W_j = \cup_F D^F_{r_j}$, where the union is taken over all faces of $X$ of all dimensions.
	By construction, the restriction of $\Phi$ to the intersection of the interior of $W_2$ with any face of $sd(X)$ is transverse to all faces of $X$.

	As in the proof of \cref{T: transverse complex}, we next follow the construction in \cite[Section 2.3]{GuPo74}.
	We have $M$ embedded in some Euclidean space $\R^N$ with an $\epsilon$-neighborhood $M^\epsilon$ and a submersion $\pi \colon M^\epsilon \to M$; we also assume $\epsilon(x)<1$ for all $x \in M$.
	As we are happy with the map $\Phi$ as constructed so far on the interior of $W_2$, we let $\rho \colon M \to [0,1)$ be a smooth function that is $0$ on $W_3$ and positive on $M-W_3$.
	We will fine tune $\rho$ a bit more soon.
	Let $S$ be the open unit ball in $\R^N$.
	We now consider the map $H \colon M \times S \to M$ defined by $H(x,s) = \pi(\Phi(x)+\rho(x)\epsilon(\Phi(x)) s)$.
	At all points $(x,s)$ such that $\rho(x)>0$, i.e.\ on $M-W_3$, this is a submersion (and so transverse to all faces of $X$), and for all $(x,s)$ such that $\rho(x) = 0$, i.e.\ on $W_3$, we have $H(x,s) = \pi(\Phi(x)) = \Phi(x)$.

	Now let $G$ be the interior of any face of the cubical subdivision $sd(X)$.
	At any point $x \in G \cap W_3$, we already have that for any fixed $s_0 \in S$ the map $H|_G(-,s_0) = \Phi|_G(-)$ is transverse at $x$ to any face of $X$.
	Furthermore, by the Transversality Theorem of \cite{GuPo74}, for almost every $s_0 \in S$ and for any face $F$ of $X$, the map $H|_G(-,s_0)$ is transverse to the interior of $F$ at all points on the submanifold $G-G \cap W_3$ of $G$.
	But there are a countable number of faces of $X$, so for almost every $s_0 \in S$ and for every face $F$ of $X$, the map $H|_G(-,s_0)$ is transverse to the interior of $F$.
	But there are also only a countable number of faces of $sd(X)$, and so for almost every $s_0 \in S$, $H|_G(-,s_0)$ is transverse to the interior of $F$ at every point in the interior of $G$, for every $G$ and every $F$.
	Lastly, $H(-,s_0)$ is homotopic to $\Phi$ via $H(-, ts_0)$.

	To complete the proof we must do one last thing: we must fine tune $\rho$ to ensure that in forming $H(-,s_0)$ to obtain the required transversality we have not pushed any $F^\vee$ so far as to create new intersections with $\dim(F)$ faces of $X$ beyond the single desired intersection of $H(F^\vee,s_0)$ with $F$ that was obtained earlier using the map $\Phi$.
	For this we do the following.

	Recall that $H(-,s_0) = \Phi$ on $W_3$, and that $\Phi$ already creates the desired intersection between each $F$ and a point in the image of $W_4$.
	As noted above, if $F$ is any face of $X$ then the distance between $\Phi(F^\vee-(F^\vee \cap W_4))$ and the union of $\dim(F)$-faces of $X$ is positive.
	Now suppose $x \in M-W_4$ and consider a compact neighborhood $\bar U_x$ of $x$ in $M-W_4$.
	By the above, if $\bar U_x \cap F^\vee \neq \emptyset$, then there is a positive distance between $\Phi(\bar U_x \cap F^\vee)$ and the $\dim(F)$-skeleton of the cubulation.
	So using the Tube Lemma as in the proof of \cref{P: ball stability}, there is an $\varepsilon_{x,F} > 0$ such that $H(z,s)$ does not intersect the $\dim(F)$-skeleton of the cubulation for any $z \in \bar U_x \cap F^\vee$ and any $s$ with $|s| \leq \varepsilon_{x,F}$.
	As $\bar U_x$ is compact, it intersects only a finite number of $F^\vee$ as $F$ ranges over all faces of $X$, and we let $$\varepsilon_x = \min\{\varepsilon_{x,F} \mid \bar U_x \cap F^\vee\neq \emptyset\}.$$
	So, by construction, any map $g \colon M \to M$ such that $d(z,g(z))<\varepsilon_x$ for all $z \in \bar U_x$ satisfies the property that if $z \in F^\vee \cap \bar U_x$ then $g(z)$ is not contained in a $\dim(F)$ face of $X$.

	Now, suppose we have constructed such an $\varepsilon_x$ for all $x$ in $M - W_4$.
	Then the interiors $U_x$ of the $\bar U_x$ cover $M - W_4$, and since $M - W_4$ is a subspace of the Euclidean metric space $\R^N$, we can take a locally finite refinement $\mc U$.
	By \cref{L: minimizer}, we can find a smooth function $\rho_1 \colon M - W_4 \to \R$ so that $0<\rho_1(z)<\varepsilon_x$ if $z \in \bar U_x$ for $U_x \in \mc U$.
	Let $\rho_2 = \rho\rho_1 \colon M \to \R$, where $\rho$ is as chosen above.
	This is smooth and well defined on all of $M$ as $\rho(x) = 0$ for all $x \in W_3$ and $W_4 \subset int(W_3)$.
	We also see that $0<\rho_2(x)<\rho_1(x)$ for all $x \in M - W_4$.
	So now if we replace $H$ with $H_2 \colon M \times S \to M$ defined by $H_2(x,s) = \pi(\Phi(x)+\rho_2(x)\epsilon(\Phi(x)) s)$, then for any $s_0 \in S$ and for any $x \in (M - W_4) \cap F^\vee$, we have that $H_2(x,s_0)$ does not intersect any face of dimension $\dim(F)$ as desired.
	We can now set $h(-) = H_2(-,s_0)$ for almost all $s_0$ to achieve all three required conditions, noting that the conclusions of the preceding paragraphs did not depend on the choice of $\rho$.

	Lastly, we observe that the homotopies from the identity to $\Phi$ and from $\Phi$ to $h$ (given by $H_2(-,ts_0)$) can be taken to be proper by an application of \cref{L: nearby proper homotopy} as in the proof of \cref{P: ball stability}, assuming we make all of our homotopies above yet smaller if necessary to meet the requirements of \cref{L: nearby proper homotopy}.
\end{proof}

\subsubsection{The intersection map is an isomorphism for finitely-generated cohomology groups}

We are nearly ready to prove \cref{T: intersection qi}, which we restate here:



\begin{theorem*}[\cref{T: intersection qi}]
	If $M$ is a manifold without boundary cubulated by $X$, the intersection map $\mc I \colon H^i_{\Gamma \pf X}(M) \to H^i(X)$ is a surjection.
	If, in addition, $H^i(M)$ is finitely generated, then $\mc I$ is an isomorphism.
\end{theorem*}

The last piece is a basic fact about finitely-generated abelian groups:


\begin{lemma}\label{L: surjection of isomorphic groups}
	Every surjection of isomorphic finitely-generated abelian groups is an isomorphism.
\end{lemma}
\begin{proof}
	First, let $A$ be a finitely-generated abelian group, and let $f \colon A \to A$ be a surjection.
	Let $f^p$ denote the $p$-th iteration of $f$.
	We have $\ker(f)\subseteq \ker (f^2) \subseteq \cdots$, but since $A$ is a finitely-generated module over the Noetherian ring $\Z$, this sequence stabilizes; say $\ker(f^n)=\ker(f^{n+1})$ for some $n$.
	Suppose $x \in A$ with $f(x) = 0$. As $f$ is surjective, so is each $f^p$ and thus $x = f^n(y)$ for some $y \in A$.
	Then $0 = f(x) = f(f^n(y)) = f^{n+1}(y)$.
	But $\ker(f^n) = \ker(f^{n+1})$, so $x= f^n(y) = 0$.
	Thus $f$ is also injective and so an isomorphism.

	If instead $f: A \to B$ is a surjection of isomorphic abelian groups with $\phi: B \to A$ the isomorphism, then the above applies to $\phi f \colon A \to A$, and so $\phi^{-1}(\phi f) = f$ is a composition of isomorphisms and so an isomorphism.
\end{proof}

At last we prove \cref{T: intersection qi}.


\begin{proof}[Proof of \cref{T: intersection qi}]
	In \cref{S: dualization of complexes} we constructed a chain map $\Psi \colon K^*(X) \to C_\Gamma^*(M)$ by taking each $F^* \in K^*(X)$ to the geometric cochain represented by the inclusion of $F^\vee$ into $M$, but the image did not lie in $C^*_{\Gamma \pf X}(M)$.
	To remedy this, we define $\psi \colon K^*(X) \to C_{\Gamma \pf X}^*(M)$ as the composition of $\Psi$ with the chain map on $C^*_{\Gamma}(M)$ determined by the map $h$ constructed in \cref{L: push dual}.
	This last is a chain map by \cref{C: proper cofunctoriality}, using \cref{D: homotopy co-orientation} to co-orient $h$ with the co-orientation induced by $h$ being homotopic to the identity map of $M$, which we give its tautological co-orientation.
	Furthermore, for each face $F^*$ of $K^*(X)$, we have by construction that $\psi(F^*)$ can be represented by a precochain that is transverse to the cubulation.
	So $\psi$ has image in $C_{\Gamma \pf X}^*(M)$ as desired.

	By \cref{L: push dual} and the definitions, we have for each pair of faces $F$ and $f$ of $X$ of the same dimension that
	\begin{equation*}
		(\mc I \psi(F^*))(f) = (\mc I h \Psi(F^*))(f)\\
		= (\mc I h (F^\vee))(f)\\
		= I( h (F^\vee) , f) \\
		=
		\begin{cases}
			1, & F=f,\\
			0, & \text{otherwise.}
		\end{cases}
	\end{equation*}
	So the composition $\mc I \psi$ is the identity on $K^*(X)$, and it follows that $\mc I$ induces a cohomology surjection $H^*_{\Gamma \pf X}(M)\onto H^*(X)$.

	We know from \cref{T: geometric is singular} and the isomorphisms among cubical, singular cubical, and singular simplicial cohomologies that $H^i_{\Gamma \pf X}(M)$ and $H^i(X)$ are both isomorphic to the singular simplicial cohomology group $H^i(M)$.
	So the last claim holds by \cref{L: surjection of isomorphic groups}.
\end{proof}

We conjecture that $\mc I$ is an isomorphism in the general case but have not been able to prove this.
